<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">

<script>
    (function(){
        if(''){
            if (prompt('请输入文章密码') !== ''){
                alert('密码错误！');
                history.back();
            }
        }
    })();
</script>








<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/amuuncle32.jpg?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/amuuncle16.jpg?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="我的梦想就是努力实现小时候吹过的牛！">
<meta property="og:type" content="website">
<meta property="og:title" content="AmuUncle">
<meta property="og:url" content="http://amuuncle.site/index.html">
<meta property="og:site_name" content="AmuUncle">
<meta property="og:description" content="我的梦想就是努力实现小时候吹过的牛！">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="AmuUncle">
<meta name="twitter:description" content="我的梦想就是努力实现小时候吹过的牛！">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://amuuncle.site/"/>





  <title>AmuUncle</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?8f32f215d9497a6235932a68154fff59";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">AmuUncle</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">我不想做个单纯优秀的人，而是要去做个无法替代的人。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            博客列表
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/baidusitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://amuuncle.site/2017/11/08/工具使用-第3节-HEXO美化之添加虾米音乐播放器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="阿木大叔">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ip.freep.cn/593194/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AmuUncle">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/08/工具使用-第3节-HEXO美化之添加虾米音乐播放器/" itemprop="url">工具使用--第3节 HEXO美化之添加虾米音乐播放器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-08T21:45:43+08:00">
                2017-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GitHub/" itemprop="url" rel="index">
                    <span itemprop="name">GitHub</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>先看看效果图：<br><img src="http://img.blog.csdn.net/20171108212820087?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="1-获取播放器链接"><a href="#1-获取播放器链接" class="headerlink" title="1. 获取播放器链接"></a>1. 获取播放器链接</h2><p>我用浏览器打开虾米播播网址：<br>[<a href="http://www.xiami.com/widget?widget_from=42036317" target="_blank" rel="external">http://www.xiami.com/widget?widget_from=42036317</a>]<br><img src="http://img.blog.csdn.net/20171108213040901?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>这里可以制作三款应用，分别是歌曲播放器列表，唱片墙，歌曲播放器（单曲）；这些都可以，这里只介绍第一种<strong>歌曲播放器列表</strong>。<br>点击下方的立即制作，进入制作页面：<br><img src="http://img.blog.csdn.net/20171108213345959?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>自行添加音乐，然后下面就会出现播放器的代码：<br><img src="http://img.blog.csdn.net/20171108213453075?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>我们复制中间的HTML代码；</p>
<h2 id="2-添加到NEXT主题"><a href="#2-添加到NEXT主题" class="headerlink" title="2. 添加到NEXT主题"></a>2. 添加到NEXT主题</h2><p>进入NEXT主题目录，如下图路径（\themes\next\layout_custom）：<br><img src="http://img.blog.csdn.net/20171108213705699?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>我们以记事本的方式打开该目录下的sidebar.swig文件，这就是NEXT主题的侧边栏文件，打开之后应该是空白文件，我们把上面复制的HTML代码粘贴到这里面就好了；</p>
<h2 id="3-生成部署"><a href="#3-生成部署" class="headerlink" title="3. 生成部署"></a>3. 生成部署</h2><p>在hexo的根目录下运行：</p>
<blockquote>
<p>hexo s -g</p>
</blockquote>
<p>生成网站并运行网站，如图所示：<br><img src="http://img.blog.csdn.net/20171108214129098?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>接下来我们打开<a href="http://127.0.0.1:4000/就能看到我们添加的音乐播放器：" target="_blank" rel="external">http://127.0.0.1:4000/就能看到我们添加的音乐播放器：</a><br><img src="http://img.blog.csdn.net/20171108214249718?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>你也可以运行</p>
<blockquote>
<p>hexo d -g</p>
</blockquote>
<p>来将网站部署到github上，效果相同；<br>具体效果可以打开我的个人博客来看看:<a href="http://amuuncle.site/">http://amuuncle.site/</a></p>
<h3 id="项目源码可以访问我的码云"><a href="#项目源码可以访问我的码云" class="headerlink" title="项目源码可以访问我的码云"></a><a href="https://gitee.com/AmuUncle/MFC_CSDN.git" target="_blank" rel="external">项目源码可以访问我的码云</a></h3><h3 id="gt-gt-gt-我的私人博客-lt-lt-lt"><a href="#gt-gt-gt-我的私人博客-lt-lt-lt" class="headerlink" title="&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;"></a><a href="http://amuuncle.site/">&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;</a></h3>
          
        
      
    </div>
    
    
    
	
	
    

    

    
	

	
	<div>
		
	</div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://amuuncle.site/2017/11/08/第19节-MFC之自定义消息/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="阿木大叔">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ip.freep.cn/593194/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AmuUncle">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/08/第19节-MFC之自定义消息/" itemprop="url">第19节 MFC之自定义消息</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-08T21:25:28+08:00">
                2017-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MFC从入门到放弃/" itemprop="url" rel="index">
                    <span itemprop="name">MFC从入门到放弃</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Windows编程基础–第19节-MFC之自定义消息"><a href="#Windows编程基础–第19节-MFC之自定义消息" class="headerlink" title="Windows编程基础–第19节 MFC之自定义消息"></a>Windows编程基础–第19节 MFC之自定义消息</h1><p>windows程序中最重要的就是消息机制，前面几节我们都是使用Windows系统设定好的消息进行编程，今天我们来使用自定义的消息来看看MFC中消息的传递过程；<br>MFC中自定义消息有两种方法：</p>
<blockquote>
<ol>
<li>#define WM_MY_DEFINED_MSG (WM_USR+100)</li>
<li>RegisterWindowMessage(WM_MY_REGISTER_MSG_SRR)<br>下面我们来尝试一下这两种方法有什么不同；</li>
</ol>
</blockquote>
<h2 id="1-新建项目"><a href="#1-新建项目" class="headerlink" title="1. 新建项目"></a>1. 新建项目</h2><p>新建一个基于对话框项目“day21”，布局如下，自行处理：<br><img src="http://img.blog.csdn.net/20171108205056148?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="2-第一种自定义消息"><a href="#2-第一种自定义消息" class="headerlink" title="2.第一种自定义消息"></a>2.第一种自定义消息</h2><h3 id="2-1-定义消息ID"><a href="#2-1-定义消息ID" class="headerlink" title="2.1 定义消息ID"></a>2.1 定义消息ID</h3><p>我们来到day20Dlg.h 的头文件中，在上方创建一个宏定义如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#define WM_MY_FRIST_MSG (WM_USER + 100)</div></pre></td></tr></table></figure>
<p>这里我们定义了一个WM_MY_FRIST_MSG整型数值，它的值时WM_USER + 100，其中<strong>WM_USER </strong>是微软定义好的宏，它的值是:<code>#define WM_USER                         0x0400</code> ，这说明在0x0400之前的消息(包含0x0400)都已经被windows系统使用，我们自定义消息只能在这之后，所以我们加上了100；</p>
<h3 id="2-2-映射消息函数"><a href="#2-2-映射消息函数" class="headerlink" title="2.2  映射消息函数"></a>2.2  映射消息函数</h3><p>我们切换到day20Dlg.cpp中，找到下面这地方：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">BEGIN_MESSAGE_MAP(Cday21Dlg, CDialogEx)</div><div class="line">	ON_WM_SYSCOMMAND()</div><div class="line">	ON_WM_PAINT()</div><div class="line">	ON_WM_QUERYDRAGICON()</div><div class="line">END_MESSAGE_MAP()</div></pre></td></tr></table></figure></p>
<p>这就是消息的关系图，我们来添加一条映射，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">BEGIN_MESSAGE_MAP(Cday21Dlg, CDialogEx)</div><div class="line">	ON_WM_SYSCOMMAND()</div><div class="line">	ON_WM_PAINT()</div><div class="line">	ON_WM_QUERYDRAGICON()</div><div class="line">	ON_MESSAGE(WM_MY_FRIST_MSG, &amp;Cday21Dlg::OnMyFirstMsgTrigger)</div><div class="line">END_MESSAGE_MAP()</div></pre></td></tr></table></figure>
<blockquote>
<p>ON_MESSAGE(WM_MY_FRIST_MSG, &amp;Cday21Dlg::OnMyFirstMsgTrigger)<br>说明将WM_MY_FRIST_MSG消息ID与类Cday21Dlg的OnMyFirstMsgTrigger成员函数对应，当WM_MY_FRIST_MSG消息被触发时将调用OnMyFirstMsgTrigger方法；</p>
</blockquote>
<h3 id="2-3-实现消息函数"><a href="#2-3-实现消息函数" class="headerlink" title="2.3  实现消息函数"></a>2.3  实现消息函数</h3><p>我们先切换到Cday21Dlg类中，添加OnMyFirstMsgTrigger方法的声明：</p>
<blockquote>
<p>afx_msg LRESULT OnMyFirstMsgTrigger(WPARAM wParam,  LPARAM lParam);<br>这是消息映射函数的固定格式，参数类型也是固定的；</p>
</blockquote>
<p>接下来我们实现OnMyFirstMsgTrigger的定义,如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">LRESULT Cday21Dlg::OnMyFirstMsgTrigger(WPARAM wParam,  LPARAM lParam)</div><div class="line">&#123;</div><div class="line">	TCHAR szBuf[128];</div><div class="line">	_stprintf(szBuf,_T(&quot;消息：%s 被触发，消息ID: 0x%x &quot;),_T(&quot;WM_MY_FRIST_MSG&quot;),WM_MY_FRIST_MSG); </div><div class="line">    AfxMessageBox(szBuf);</div><div class="line">	return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<ol>
<li>只要执行这个函数就会弹窗显示消息名称和ID；</li>
</ol>
</blockquote>
<h3 id="2-4-发送消息"><a href="#2-4-发送消息" class="headerlink" title="2.4  发送消息"></a>2.4  发送消息</h3><p>我们双击资源界面上的“自定义消息ID”按钮，编辑其点击事件处理函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">void Cday21Dlg::OnBnClickedBtnDefined()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line"></div><div class="line">	PostMessage(WM_MY_FRIST_MSG,0,0);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<ol>
<li>使用PostMessage发送WM_MY_FRIST_MSG消息；</li>
</ol>
</blockquote>
<h3 id="2-5-运行结果"><a href="#2-5-运行结果" class="headerlink" title="2.5  运行结果"></a>2.5  运行结果</h3><p><img src="http://img.blog.csdn.net/20171108210903808?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="3-第二种自定义消息"><a href="#3-第二种自定义消息" class="headerlink" title="3.第二种自定义消息"></a>3.第二种自定义消息</h2><h3 id="3-1-定义消息ID"><a href="#3-1-定义消息ID" class="headerlink" title="3.1 定义消息ID"></a>3.1 定义消息ID</h3><p>由于我们需要使用RegisterWindowMessage(LPCSTR lpString)来创造消息ID，所以我们需要先定义一个字符串：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">#define WM_MY_REGISTER_MSG_SRR _T(&quot;WM_MY_REGISTER_MSG_SRR&quot;)</div></pre></td></tr></table></figure>
<p>接下来我们定义一个全局变量WM_MY_REGISTER_MSG来作为消息ID；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">UINT WM_MY_REGISTER_MSG;</div></pre></td></tr></table></figure>
<p>接下来我们来初始化消息ID，我们到Cday21Dlg类的构造函数中来创建消息ID：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Cday21Dlg::Cday21Dlg(CWnd* pParent /*=NULL*/)</div><div class="line">	: CDialogEx(Cday21Dlg::IDD, pParent)</div><div class="line">&#123;</div><div class="line">	m_hIcon = AfxGetApp()-&gt;LoadIcon(IDR_MAINFRAME);</div><div class="line">	WM_MY_REGISTER_MSG = RegisterWindowMessage(WM_MY_REGISTER_MSG_SRR);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这样我们就通过RegisterWindowMessage来创建了消息ID，但只有在程序运行时我们才会知道消息ID是多少，并且每次运行时都可能不同；</p>
<h3 id="3-2-映射消息函数"><a href="#3-2-映射消息函数" class="headerlink" title="3.2  映射消息函数"></a>3.2  映射消息函数</h3><p>我们切换到day20Dlg.cpp中，我们再来添加一条映射，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">BEGIN_MESSAGE_MAP(Cday21Dlg, CDialogEx)</div><div class="line">	ON_WM_SYSCOMMAND()</div><div class="line">	ON_WM_PAINT()</div><div class="line">	ON_WM_QUERYDRAGICON()</div><div class="line">	ON_BN_CLICKED(IDC_BTN_DEFINED, &amp;Cday21Dlg::OnBnClickedBtnDefined)</div><div class="line">	ON_MESSAGE(WM_MY_FRIST_MSG, &amp;Cday21Dlg::OnMyFirstMsgTrigger)</div><div class="line">	ON_REGISTERED_MESSAGE(WM_MY_REGISTER_MSG, &amp;Cday21Dlg::OnMyRegisterMsgTrigger)</div><div class="line">	ON_BN_CLICKED(IDC_BTN_REG, &amp;Cday21Dlg::OnBnClickedBtnReg)</div><div class="line">END_MESSAGE_MAP()</div></pre></td></tr></table></figure>
<blockquote>
<p>ON_REGISTERED_MESSAGE(WM_MY_REGISTER_MSG, &amp;Cday21Dlg::OnMyRegisterMsgTrigger)<br>说明将WM_MY_REGISTER_MSG消息ID与类Cday21Dlg的OnMyRegisterMsgTrigger成员函数对应，当WM_MY_REGISTER_MSG消息被触发时将调用OnMyRegisterMsgTrigger方法；<br>注意：RegisterWindowMessage方法获取的消息需要用ON_REGISTERED_MESSAGE映射消息</p>
</blockquote>
<h3 id="3-3-实现消息函数"><a href="#3-3-实现消息函数" class="headerlink" title="3.3  实现消息函数"></a>3.3  实现消息函数</h3><p>我们先切换到Cday21Dlg类中，添加OnMyRegisterMsgTrigger方法的声明：</p>
<blockquote>
<p>afx_msg LRESULT OnMyRegisterMsgTrigger(WPARAM wParam,  LPARAM lParam);<br>这是消息映射函数的固定格式，参数类型也是固定的；</p>
</blockquote>
<p>接下来我们实现OnMyRegisterMsgTrigger的定义,如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">LRESULT Cday21Dlg::OnMyRegisterMsgTrigger(WPARAM wParam,  LPARAM lParam)</div><div class="line">&#123;</div><div class="line">	TCHAR szBuf[128];</div><div class="line">	_stprintf(szBuf,_T(&quot;消息：%s 被触发，消息ID: 0x%x &quot;),_T(&quot;WM_MY_REGISTER_MSG&quot;),WM_MY_REGISTER_MSG); </div><div class="line">	AfxMessageBox(szBuf);</div><div class="line">	return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<ol>
<li>只要执行这个函数就会弹窗显示消息名称和ID；</li>
</ol>
</blockquote>
<h3 id="2-4-发送消息-1"><a href="#2-4-发送消息-1" class="headerlink" title="2.4  发送消息"></a>2.4  发送消息</h3><p>我们双击资源界面上的“REGISTER消息ID”按钮，编辑其点击事件处理函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">void Cday21Dlg::OnBnClickedBtnReg()</div><div class="line">&#123;</div><div class="line">	PostMessage(WM_MY_REGISTER_MSG,0,0);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<ol>
<li>使用PostMessage发送WM_MY_REGISTER_MSG消息；</li>
</ol>
</blockquote>
<h3 id="2-5-运行结果-1"><a href="#2-5-运行结果-1" class="headerlink" title="2.5  运行结果"></a>2.5  运行结果</h3><p><img src="http://img.blog.csdn.net/20171108211915315?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="4-对比两种方法"><a href="#4-对比两种方法" class="headerlink" title="4.对比两种方法"></a>4.对比两种方法</h2><p>从上面两种方法我们可以看出其优缺点：</p>
<blockquote>
<ol>
<li>#define WM_MY_DEFINED_MSG (WM_USR+100)<br>定义的消息ID唯一，但不确定消息ID是否被其它地方占用，可能造成隐患；</li>
<li>RegisterWindowMessage(WM_MY_REGISTER_MSG_SRR)<br>优点：定义的消息ID唯一，独立；缺点：在程序运行前不能确定消息ID，不方便在其它程序中指定触发此消息ID；</li>
</ol>
</blockquote>
<h3 id="项目源码可以访问我的码云"><a href="#项目源码可以访问我的码云" class="headerlink" title="项目源码可以访问我的码云"></a><a href="https://gitee.com/AmuUncle/MFC_CSDN.git" target="_blank" rel="external">项目源码可以访问我的码云</a></h3><h3 id="gt-gt-gt-我的私人博客-lt-lt-lt"><a href="#gt-gt-gt-我的私人博客-lt-lt-lt" class="headerlink" title="&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;"></a><a href="http://amuuncle.site/">&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;</a></h3>
          
        
      
    </div>
    
    
    
	
	
    

    

    
	

	
	<div>
		
	</div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://amuuncle.site/2017/11/06/第18节-MFC之窗体操作/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="阿木大叔">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ip.freep.cn/593194/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AmuUncle">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/06/第18节-MFC之窗体操作/" itemprop="url">第18节 MFC之窗体操作</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-06T21:17:31+08:00">
                2017-11-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MFC从入门到放弃/" itemprop="url" rel="index">
                    <span itemprop="name">MFC从入门到放弃</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>今天学习一下MFC窗体的基本操作：</p>
<blockquote>
<ul>
<li>最大化</li>
<li>最小化</li>
<li>还原</li>
<li>关闭窗口</li>
<li>设置窗口大小</li>
<li>设置窗口位置</li>
<li>居中显示窗口</li>
<li>顶层显示窗口</li>
<li>设置窗口图标</li>
<li>获取窗口标题</li>
<li>设置窗口标题</li>
</ul>
</blockquote>
<h2 id="1-最大化"><a href="#1-最大化" class="headerlink" title="1. 最大化"></a>1. 最大化</h2><blockquote>
<p>SendMessage(WM_SYSCOMMAND,SC_MAXIMIZE,0)</p>
</blockquote>
<h2 id="2-最小化"><a href="#2-最小化" class="headerlink" title="2. 最小化"></a>2. 最小化</h2><blockquote>
<p>SendMessage(WM_SYSCOMMAND,SC_MINIMIZE,0)</p>
</blockquote>
<h2 id="3-还原窗口"><a href="#3-还原窗口" class="headerlink" title="3. 还原窗口"></a>3. 还原窗口</h2><blockquote>
<p>SendMessage(WM_SYSCOMMAND,SC_RESTORE,0)</p>
</blockquote>
<h2 id="4-关闭窗口"><a href="#4-关闭窗口" class="headerlink" title="4. 关闭窗口"></a>4. 关闭窗口</h2><blockquote>
<p>SendMessage(WM_CLOSE,0,0)</p>
</blockquote>
<h2 id="5-设置窗口大小及位置"><a href="#5-设置窗口大小及位置" class="headerlink" title="5. 设置窗口大小及位置"></a>5. 设置窗口大小及位置</h2><blockquote>
<p>MoveWindow(100,200,600,450);<br>或<br>SetWindowPos(NULL,500,100,700,500,SWP_NOZORDER);</p>
</blockquote>
<h2 id="6-居中显示窗口"><a href="#6-居中显示窗口" class="headerlink" title="6. 居中显示窗口"></a>6. 居中显示窗口</h2><blockquote>
<p>SendMessage(WM_CLOSE,0,0)</p>
</blockquote>
<h2 id="7-顶层显示窗口"><a href="#7-顶层显示窗口" class="headerlink" title="7.顶层显示窗口"></a>7.顶层显示窗口</h2><blockquote>
<p>设置顶层显示<br>::SetWindowPos(m_hWnd,HWND_TOPMOST,0,0,0,0,SWP_NOMOVE|SWP_NOSIZE);</p>
<p>取消顶层显示<br>::SetWindowPos(m_hWnd,HWND_NOTOPMOST,0,0,0,0,SWP_NOMOVE|SWP_NOSIZE);</p>
</blockquote>
<h2 id="8-设置窗口图标"><a href="#8-设置窗口图标" class="headerlink" title="8.设置窗口图标"></a>8.设置窗口图标</h2><blockquote>
<pre><code>HICON hIcon = AfxGetApp()-&gt;LoadIcon(IDI_ICON_LOL);
 SetIcon(hIcon, TRUE);            // 设置大图标
  SetIcon(hIcon, FALSE);        // 设置小图标
</code></pre></blockquote>
<h2 id="9-获取窗口标题"><a href="#9-获取窗口标题" class="headerlink" title="9.获取窗口标题"></a>9.获取窗口标题</h2><blockquote>
<p>GetWindowText(str);</p>
</blockquote>
<h2 id="10-设置窗口标题"><a href="#10-设置窗口标题" class="headerlink" title="10.设置窗口标题"></a>10.设置窗口标题</h2><blockquote>
<p>SetWindowText(_T(“LOL”));</p>
</blockquote>
<p>附源码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div></pre></td><td class="code"><pre><div class="line">// day20Dlg.cpp : 实现文件</div><div class="line">//</div><div class="line"></div><div class="line">#include &quot;stdafx.h&quot;</div><div class="line">#include &quot;day20.h&quot;</div><div class="line">#include &quot;day20Dlg.h&quot;</div><div class="line">#include &quot;afxdialogex.h&quot;</div><div class="line"></div><div class="line">#ifdef _DEBUG</div><div class="line">#define new DEBUG_NEW</div><div class="line">#endif</div><div class="line"></div><div class="line"></div><div class="line">// 用于应用程序“关于”菜单项的 CAboutDlg 对话框</div><div class="line"></div><div class="line">class CAboutDlg : public CDialogEx</div><div class="line">&#123;</div><div class="line">public:</div><div class="line">	CAboutDlg();</div><div class="line"></div><div class="line">// 对话框数据</div><div class="line">	enum &#123; IDD = IDD_ABOUTBOX &#125;;</div><div class="line"></div><div class="line">	protected:</div><div class="line">	virtual void DoDataExchange(CDataExchange* pDX);    // DDX/DDV 支持</div><div class="line"></div><div class="line">// 实现</div><div class="line">protected:</div><div class="line">	DECLARE_MESSAGE_MAP()</div><div class="line">&#125;;</div><div class="line"></div><div class="line">CAboutDlg::CAboutDlg() : CDialogEx(CAboutDlg::IDD)</div><div class="line">&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line">void CAboutDlg::DoDataExchange(CDataExchange* pDX)</div><div class="line">&#123;</div><div class="line">	CDialogEx::DoDataExchange(pDX);</div><div class="line">&#125;</div><div class="line"></div><div class="line">BEGIN_MESSAGE_MAP(CAboutDlg, CDialogEx)</div><div class="line">END_MESSAGE_MAP()</div><div class="line"></div><div class="line"></div><div class="line">// Cday20Dlg 对话框</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">Cday20Dlg::Cday20Dlg(CWnd* pParent /*=NULL*/)</div><div class="line">	: CDialogEx(Cday20Dlg::IDD, pParent)</div><div class="line">&#123;</div><div class="line">	m_hIcon = AfxGetApp()-&gt;LoadIcon(IDR_MAINFRAME);</div><div class="line">&#125;</div><div class="line"></div><div class="line">void Cday20Dlg::DoDataExchange(CDataExchange* pDX)</div><div class="line">&#123;</div><div class="line">	CDialogEx::DoDataExchange(pDX);</div><div class="line">&#125;</div><div class="line"></div><div class="line">BEGIN_MESSAGE_MAP(Cday20Dlg, CDialogEx)</div><div class="line">	ON_WM_SYSCOMMAND()</div><div class="line">	ON_WM_PAINT()</div><div class="line">	ON_WM_QUERYDRAGICON()</div><div class="line">	ON_BN_CLICKED(IDC_BUTTON1, &amp;Cday20Dlg::OnBnClickedButton1)</div><div class="line">	ON_BN_CLICKED(IDC_BUTTON2, &amp;Cday20Dlg::OnBnClickedButton2)</div><div class="line">	ON_BN_CLICKED(IDC_BUTTON3, &amp;Cday20Dlg::OnBnClickedButton3)</div><div class="line">	ON_BN_CLICKED(IDC_BUTTON4, &amp;Cday20Dlg::OnBnClickedButton4)</div><div class="line">	ON_WM_CLOSE()</div><div class="line">	ON_BN_CLICKED(IDC_BUTTON5, &amp;Cday20Dlg::OnBnClickedButton5)</div><div class="line">	ON_BN_CLICKED(IDC_BUTTON6, &amp;Cday20Dlg::OnBnClickedButton6)</div><div class="line">	ON_BN_CLICKED(IDC_BUTTON7, &amp;Cday20Dlg::OnBnClickedButton7)</div><div class="line">	ON_BN_CLICKED(IDC_CHECK1, &amp;Cday20Dlg::OnBnClickedCheck1)</div><div class="line">	ON_BN_CLICKED(IDC_BUTTON8, &amp;Cday20Dlg::OnBnClickedButton8)</div><div class="line">	ON_BN_CLICKED(IDC_BUTTON9, &amp;Cday20Dlg::OnBnClickedButton9)</div><div class="line">END_MESSAGE_MAP()</div><div class="line"></div><div class="line"></div><div class="line">// Cday20Dlg 消息处理程序</div><div class="line"></div><div class="line">BOOL Cday20Dlg::OnInitDialog()</div><div class="line">&#123;</div><div class="line">	CDialogEx::OnInitDialog();</div><div class="line"></div><div class="line">	// 将“关于...”菜单项添加到系统菜单中。</div><div class="line"></div><div class="line">	// IDM_ABOUTBOX 必须在系统命令范围内。</div><div class="line">	ASSERT((IDM_ABOUTBOX &amp; 0xFFF0) == IDM_ABOUTBOX);</div><div class="line">	ASSERT(IDM_ABOUTBOX &lt; 0xF000);</div><div class="line"></div><div class="line">	CMenu* pSysMenu = GetSystemMenu(FALSE);</div><div class="line">	if (pSysMenu != NULL)</div><div class="line">	&#123;</div><div class="line">		BOOL bNameValid;</div><div class="line">		CString strAboutMenu;</div><div class="line">		bNameValid = strAboutMenu.LoadString(IDS_ABOUTBOX);</div><div class="line">		ASSERT(bNameValid);</div><div class="line">		if (!strAboutMenu.IsEmpty())</div><div class="line">		&#123;</div><div class="line">			pSysMenu-&gt;AppendMenu(MF_SEPARATOR);</div><div class="line">			pSysMenu-&gt;AppendMenu(MF_STRING, IDM_ABOUTBOX, strAboutMenu);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	// 设置此对话框的图标。当应用程序主窗口不是对话框时，框架将自动</div><div class="line">	//  执行此操作</div><div class="line">	SetIcon(m_hIcon, TRUE);			// 设置大图标</div><div class="line">	SetIcon(m_hIcon, FALSE);		// 设置小图标</div><div class="line"></div><div class="line">	HICON hIcon = AfxGetApp()-&gt;LoadIcon(IDI_ICON_LOL);</div><div class="line">	SetIcon(hIcon, TRUE);			// 设置大图标</div><div class="line">	SetIcon(hIcon, FALSE);		// 设置小图标</div><div class="line"></div><div class="line">	SetWindowText(_T(&quot;LOL&quot;));</div><div class="line"></div><div class="line"></div><div class="line">	// TODO: 在此添加额外的初始化代码</div><div class="line"></div><div class="line">	return TRUE;  // 除非将焦点设置到控件，否则返回 TRUE</div><div class="line">&#125;</div><div class="line"></div><div class="line">void Cday20Dlg::OnSysCommand(UINT nID, LPARAM lParam)</div><div class="line">&#123;</div><div class="line">	if ((nID &amp; 0xFFF0) == IDM_ABOUTBOX)</div><div class="line">	&#123;</div><div class="line">		CAboutDlg dlgAbout;</div><div class="line">		dlgAbout.DoModal();</div><div class="line">	&#125;</div><div class="line">	else</div><div class="line">	&#123;</div><div class="line">		CDialogEx::OnSysCommand(nID, lParam);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">// 如果向对话框添加最小化按钮，则需要下面的代码</div><div class="line">//  来绘制该图标。对于使用文档/视图模型的 MFC 应用程序，</div><div class="line">//  这将由框架自动完成。</div><div class="line"></div><div class="line">void Cday20Dlg::OnPaint()</div><div class="line">&#123;</div><div class="line">	if (IsIconic())</div><div class="line">	&#123;</div><div class="line">		CPaintDC dc(this); // 用于绘制的设备上下文</div><div class="line"></div><div class="line">		SendMessage(WM_ICONERASEBKGND, reinterpret_cast&lt;WPARAM&gt;(dc.GetSafeHdc()), 0);</div><div class="line"></div><div class="line">		// 使图标在工作区矩形中居中</div><div class="line">		int cxIcon = GetSystemMetrics(SM_CXICON);</div><div class="line">		int cyIcon = GetSystemMetrics(SM_CYICON);</div><div class="line">		CRect rect;</div><div class="line">		GetClientRect(&amp;rect);</div><div class="line">		int x = (rect.Width() - cxIcon + 1) / 2;</div><div class="line">		int y = (rect.Height() - cyIcon + 1) / 2;</div><div class="line"></div><div class="line">		// 绘制图标</div><div class="line">		dc.DrawIcon(x, y, m_hIcon);</div><div class="line">	&#125;</div><div class="line">	else</div><div class="line">	&#123;</div><div class="line">		CDialogEx::OnPaint();</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">//当用户拖动最小化窗口时系统调用此函数取得光标</div><div class="line">//显示。</div><div class="line">HCURSOR Cday20Dlg::OnQueryDragIcon()</div><div class="line">&#123;</div><div class="line">	return static_cast&lt;HCURSOR&gt;(m_hIcon);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">void Cday20Dlg::OnBnClickedButton1()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	SendMessage(WM_SYSCOMMAND,SC_MAXIMIZE,0);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">void Cday20Dlg::OnBnClickedButton2()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	SendMessage(WM_SYSCOMMAND,SC_MINIMIZE,0);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">void Cday20Dlg::OnBnClickedButton3()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	SendMessage(WM_SYSCOMMAND,SC_RESTORE,0);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">void Cday20Dlg::OnBnClickedButton4()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	SendMessage(WM_CLOSE,0,0);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">void Cday20Dlg::OnClose()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加消息处理程序代码和/或调用默认值</div><div class="line">	if ( IDYES == MessageBox(_T(&quot;关闭窗口？&quot;),NULL,MB_YESNO))</div><div class="line">	&#123;</div><div class="line">		CDialogEx::OnClose();</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">void Cday20Dlg::OnBnClickedButton5()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	MoveWindow(100,200,600,450);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">void Cday20Dlg::OnBnClickedButton6()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	SetWindowPos(NULL,500,100,700,500,SWP_NOZORDER);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">void Cday20Dlg::OnBnClickedButton7()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	CenterWindow();</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">void Cday20Dlg::OnBnClickedCheck1()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	BOOL bTop = static_cast&lt;CButton*&gt;(GetDlgItem(IDC_CHECK1))-&gt;GetCheck();</div><div class="line">	if (bTop)</div><div class="line">	&#123;</div><div class="line">		::SetWindowPos(m_hWnd,HWND_TOPMOST,0,0,0,0,SWP_NOMOVE|SWP_NOSIZE);</div><div class="line">	&#125;</div><div class="line">	else</div><div class="line">	&#123;</div><div class="line">		::SetWindowPos(m_hWnd,HWND_NOTOPMOST,0,0,0,0,SWP_NOMOVE|SWP_NOSIZE);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">void Cday20Dlg::OnBnClickedButton8()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	TCHAR tcText[20];</div><div class="line">	GetDlgItemText(IDC_EDIT_TEXT,tcText,20);</div><div class="line">	SetWindowText(tcText);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">void Cday20Dlg::OnBnClickedButton9()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	CString str;</div><div class="line">	GetWindowText(str);</div><div class="line">	AfxMessageBox(str);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="项目源码可以访问我的码云"><a href="#项目源码可以访问我的码云" class="headerlink" title="项目源码可以访问我的码云"></a><a href="https://gitee.com/AmuUncle/MFC_CSDN.git" target="_blank" rel="external">项目源码可以访问我的码云</a></h3><h3 id="gt-gt-gt-我的私人博客-lt-lt-lt"><a href="#gt-gt-gt-我的私人博客-lt-lt-lt" class="headerlink" title="&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;"></a><a href="http://amuuncle.site/">&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;</a></h3>
          
        
      
    </div>
    
    
    
	
	
    

    

    
	

	
	<div>
		
	</div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://amuuncle.site/2017/11/05/第17节-MFC之状态栏（CStatusBar）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="阿木大叔">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ip.freep.cn/593194/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AmuUncle">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/05/第17节-MFC之状态栏（CStatusBar）/" itemprop="url">第17节 MFC之状态栏（CStatusBar）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-05T19:56:26+08:00">
                2017-11-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MFC从入门到放弃/" itemprop="url" rel="index">
                    <span itemprop="name">MFC从入门到放弃</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Windows编程基础–第17节-MFC之状态栏（CStatusBar）"><a href="#Windows编程基础–第17节-MFC之状态栏（CStatusBar）" class="headerlink" title="Windows编程基础–第17节 MFC之状态栏（CStatusBar）"></a>Windows编程基础–第17节 MFC之状态栏（CStatusBar）</h1><p>  1、CStatusBar在MFC中类继承关系： </p>
<blockquote>
<p> CObject<br> CCmdTarget<br>    CWnd<br>      CControlBar<br>        CStatusBar</p>
</blockquote>
<p>2、CStatusBar成员函数介绍：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">virtual BOOL Create(</div><div class="line">   CWnd* pParentWnd,</div><div class="line">   DWORD dwStyle = WS_CHILD | WS_VISIBLE | CBRS_BOTTOM,</div><div class="line">   UINT nID = AFX_IDW_STATUS_BAR </div><div class="line">);</div></pre></td></tr></table></figure>
<blockquote>
<p>函数用途：创建一个CStatusBar并将其与CStatusBar对象关联；<br>参数说明：pParentWnd:指向CStatusBar的父窗口（Windows窗口）；<br> dwStyle：CStatusBar的类型，CBRS_TOP:将Bar放在框架的顶部，CBRS_BOTTOM:将其放在框架的底部。CBRS_NOALIGN:当父窗口改变时，不重型调整Bar；<br>nID：toolbar的子窗口ID； 返回值：成功返回非零，否则返回零；</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">BOOL SetIndicators(</div><div class="line">   const UINT* lpIDArray,</div><div class="line">   int nIDCount </div><div class="line">);</div></pre></td></tr></table></figure>
<blockquote>
<p>函数用途：加载lpIDArray中的ID所对应的字符串资源，并将ID所对应的文本保存在字符串资源中；<br>参数说明：lpIDArray：ID队列指针<br>          nIDCount：队列中元素的个数； 返回值：成功返回非零，否则返回零；</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">BOOL SetPaneText(</div><div class="line">   int nIndex,</div><div class="line">   LPCTSTR lpszNewText,</div><div class="line">   BOOL bUpdate = TRUE </div><div class="line">);</div></pre></td></tr></table></figure>
<blockquote>
<p>函数用途：将CStatustBar中的长方块设置成lpszNewText所指向的内容；<br>参数说明：nIndex：长方块的索引号（从零开始计，第零个固定用来状态指示）<br>lpszNewText：需要加载的内容；（需要在第nIndex个长方块上显示的字符串）<br>bUpdate：等于TRUE时，当加载了新的字符内容后，将长方块设置为无效。无效使得窗口自动刷行，那么新内容就被显示在界面上了。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">void GetItemRect(</div><div class="line">   int nIndex,</div><div class="line">   LPRECT lpRect </div><div class="line">) const;</div></pre></td></tr></table></figure>
<blockquote>
<p>函数用途：将nIndex所在的位置的矩形坐标拷贝到lpRect中。 参数说明：nIndex：长方块的标识；<br>lpRect：指向Rect结构的指针，用来保存获得到的矩形坐标； 返回值：无 注意：坐标是以象素为单位的，原点在左上角。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">void GetPaneInfo(</div><div class="line">   int nIndex,</div><div class="line">   UINT&amp; nID,</div><div class="line">   UINT&amp; nStyle,</div><div class="line">   int&amp; cxWidth </div><div class="line">) const；</div></pre></td></tr></table></figure>
<blockquote>
<p>函数用途：<br>获得Pane的相关信息：ID，Style，宽度。<br>参数说明：<br>nIndex：需要获得的Pane的索引<br>nID：nIndex所对应Pane的ID<br>nStyle：nIndex对应的Pane的类型；<br>cxWidth：nIndex对应的Pane的宽度； 返回值：无</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">void SetPaneInfo(</div><div class="line">   int nIndex,</div><div class="line">   UINT nID,</div><div class="line">   UINT nStyle,</div><div class="line">   int cxWidth </div><div class="line">);</div></pre></td></tr></table></figure>
<blockquote>
<p>函数说明：设置Pane的相关信息； 参数说明：nIndex：需要设置的Pane的索引；    其余和5相同； 返回值：无</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">void SetPaneStyle(</div><div class="line">   int nIndex,</div><div class="line">   UINT nStyle </div><div class="line">);</div></pre></td></tr></table></figure>
<blockquote>
<p>函数说明：设置Pane的类型 参数说明：nIndex：需要设置的Pane的索引    nStyle：类型； 返回值：无<br>nStyle的值可以为：<br> CBRS_TOP   Control bar is at top of frame window.<br>CBRS_BOTTOM   Control bar is at bottom of frame window.<br>CBRS_NOALIGN   Control bar is not repositioned when the parent is resized.</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"> UINT GetPaneStyle(</div><div class="line">   int nIndex </div><div class="line">) const；</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">函数说明：获得Pane的类型</div><div class="line">参数说明：nIndex：需要获得的Pane的索引</div><div class="line">返回值：无</div><div class="line"> </div><div class="line">举例：</div><div class="line">生成一个MFC应用程序，参照如下说明修改代码：</div><div class="line"> </div><div class="line">static UINT indicators[] =</div><div class="line">&#123;</div><div class="line"> ID_SEPARATOR,           // 状态行指示器</div><div class="line"> ID_INDICATOR_CLOCK,</div><div class="line"> ID_INDICATOR_CAPS,</div><div class="line"> ID_INDICATOR_NUM,</div><div class="line"> ID_INDICATOR_SCRL,</div><div class="line">&#125;;</div><div class="line">说明：</div><div class="line">indicator数组提供了状态栏窗格的分配信息，它的第一项一般为ID_SEPARATOR，该ID对应的窗格用来显示命令提示信息，后三项都是字符串ID，读者可以在String Table字符串资源中找到这三个字符串分别是CAP、NUM和SCRL。它们对应的三个窗格用来显示键盘的状态。</div></pre></td></tr></table></figure>
<hr>
<h2 id="1-新建项目"><a href="#1-新建项目" class="headerlink" title="1. 新建项目"></a>1. 新建项目</h2><p>新建一个基于对话框项目“day19”，布局如下，自行处理：<br><img src="http://img.blog.csdn.net/20171105192727662?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="2-添加状态栏"><a href="#2-添加状态栏" class="headerlink" title="2.添加状态栏"></a>2.添加状态栏</h2><p>切换到解决方案视图，进入day19Dlg.h头文件，添加一个CStatusBar成员变量（CStatusBar m_statusBar;），如下图：<br><img src="http://img.blog.csdn.net/20171105192941512?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>现在进入BOOL Cday19Dlg::OnInitDialog()初始化函数中创建状态栏,在return前添加如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">m_statusBar.Create(this);</div><div class="line">UINT nID[]  = &#123;10000,10001&#125;;</div><div class="line">m_statusBar.SetIndicators(nID,2);</div><div class="line">m_statusBar.SetPaneInfo(0,10000,SBPS_NORMAL,100);</div><div class="line">m_statusBar.SetPaneInfo(1,10001,SBPS_STRETCH,0);</div><div class="line">RECT rect=&#123;0&#125;;</div><div class="line">GetClientRect(&amp;rect);</div><div class="line">m_statusBar.MoveWindow(0,rect.bottom - 30,rect.right,30,TRUE);</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<p>1.创建一个状态栏到当前窗体；<br>2.创建两个状态栏Pane的ID；<br>3.在状态栏上添加两个Pane，分别为正常模式，长度为100，另一个自动填充模式；<br>4.获取窗口客户区的坐标。客户区坐标指定客户区的左上角和右下角。由于客户区坐标是相对窗口客户区的左上角而言的，因此左上角坐标为（0，0）。这里应该注意一下：坐标包含两种：屏幕坐标与客户区坐标。严格区分这两种坐标对于理解Windows编程是很重要的。<br>5.将状态栏设置到窗口的距离底部30，长度为窗口长度，高度为30的位置；</p>
</blockquote>
<p>运行结果：<br><img src="http://img.blog.csdn.net/20171105193801390?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>可以看到下方已经有了状态栏；</p>
<h2 id="3-实现状态栏方法"><a href="#3-实现状态栏方法" class="headerlink" title="3.实现状态栏方法"></a>3.实现状态栏方法</h2><p>编辑EDIT控件的属性：<br>| 属性名 | 值|<br>| ——–   |  —–:  |<br>| Multiline| true|<br>| Horizontal Scroll   |true|<br>| Vertical Scroll     |true|<br>| Want Return      |true|<br>添加EDIT控件的变量，如图所示：<br><img src="http://img.blog.csdn.net/20171105194447243?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>添加EDIT控件的OnEnChange消息处理方法：<br><img src="http://img.blog.csdn.net/20171105194821032?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>编辑EDIT控件的OnEnChange消息处理方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">void Cday19Dlg::OnEnChangeEdit1()</div><div class="line">&#123;</div><div class="line">	// TODO:  如果该控件是 RICHEDIT 控件，它将不</div><div class="line">	// 发送此通知，除非重写 CDialogEx::OnInitDialog()</div><div class="line">	// 函数并调用 CRichEditCtrl().SetEventMask()，</div><div class="line">	// 同时将 ENM_CHANGE 标志“或”运算到掩码中。</div><div class="line"></div><div class="line">	// TODO:  在此添加控件通知处理程序代码</div><div class="line">	int nLen = m_edit.GetWindowTextLength();</div><div class="line">	int linecount=m_edit.GetLineCount();</div><div class="line">	CString strText;</div><div class="line">	strText.Format(_T(&quot;字数: %d  行数: %d&quot;),nLen,linecount);</div><div class="line">	m_statusBar.SetPaneText(1,strText,TRUE);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<p>1.获取文本框中的文本长度；<br>2.获取文本框中的文本行数；<br>3.格式化文本后设置到状态栏第二个Pane中；</p>
</blockquote>
<p>最终效果图：<br><img src="http://img.blog.csdn.net/20171105195509780?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h3 id="项目源码可以访问我的码云"><a href="#项目源码可以访问我的码云" class="headerlink" title="项目源码可以访问我的码云"></a><a href="https://gitee.com/AmuUncle/MFC_CSDN.git" target="_blank" rel="external">项目源码可以访问我的码云</a></h3><h3 id="gt-gt-gt-我的私人博客-lt-lt-lt"><a href="#gt-gt-gt-我的私人博客-lt-lt-lt" class="headerlink" title="&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;"></a><a href="http://amuuncle.site/">&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;</a></h3>
          
        
      
    </div>
    
    
    
	
	
    

    

    
	

	
	<div>
		
	</div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://amuuncle.site/2017/11/04/第16节-MFC之SendMessage和PostMessage/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="阿木大叔">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ip.freep.cn/593194/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AmuUncle">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/04/第16节-MFC之SendMessage和PostMessage/" itemprop="url">第16节 MFC之SendMessage和PostMessage</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-04T23:33:16+08:00">
                2017-11-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MFC从入门到放弃/" itemprop="url" rel="index">
                    <span itemprop="name">MFC从入门到放弃</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>1、<strong>PostMessage</strong>会将消息压入窗口所在线程的消息队列，然后返回；而SendMessage则不经过消息队列，<strong>SendMessage</strong>可认为是直接调用了该窗口的窗口过程，因此在我们需要获得消息处理后的返回值的时候，就要用到<strong>SendMessage</strong>。<br>    例如：当在程序中指定如下使用：<strong>PostMessage（hWnd, WM_MSG,0,0）</strong>，那么当程序执行到PostMessage的时候，仅将消息WM_MSG压入到创建hWnd所指窗口的那个线程的消息队列，然后程序将继续执行下去，而至于程序什么时候响应该消息，则要看那个线程什么时候得到控制权；<br>    而指定如下使用：<strong>SendMessage（hWnd, WM_MSG,0,0）</strong>，那么当程序执行到该处时，将发生一次跳转：从当前位置，跳转到hWnd的窗口过程中去响应WM_MSG消息，当消息处理结束，窗口过程返回，程序又将从<strong>SendMessage</strong>后面继续执行，当然，我们可以获得窗口过程对该消息的处理结果，也即取<strong>SendMessage</strong>的返回值。（这里只是针对单线程）。</p>
<p>2、在多线程应用中，<strong>PostMessage</strong>的用法还是一样，但<strong>SendMessage</strong>则不同了。如果在线程A中向线程B所创建的一个窗口hWndB发送消息<strong>SendMessage（hWndB，WM_MSG，0，0）</strong>，那么系统将会立即将执行权从线程A切换到线程B，然后在线程B中调用hWndB的窗口过程来处理消息，并且在处理完该消息后，执行权仍然在B手中！这个时候，线程A则暂停在<strong>SendMessage</strong>处，等待下次线程A获得执行权后才继续执行，并且仍然可以获得消息处理的结果（返回值）。一般，为了避免死锁，在B中对WM_MSG做出处理之前，要加上：<br>if(InSendMessage()) RelpyMessage(lResult)； 即判断：如果该消息是发自另外一个线程，则立即 RelpyMessage，回复消息，参数lResult即是返回值。而如果是在同一个线程内，则InSendMessage()将会返回FALSE。     —百度知道</p>
</blockquote>
<p>总而言之，按我的理解，<strong>SendMessage</strong>和<strong>PostMessage</strong>都是向窗体发送消息的函数，但是<strong>PostMessage</strong>发送完消息立刻返回，不会等待消息结果，但<strong>SendMessage</strong>会等到消息返回结果再执行下一步；</p>
<p>今天我们通过各例子来试试这两种发送消息的方法；</p>
<blockquote>
<p>创建一个界面图标，通过拖动图标到任意的windows窗口上，获取到窗口的句柄，标题，类名；并通过<strong>SendMessage</strong>或<strong>PostMessage</strong>发送消息到该窗口，修改窗口标题或关闭窗口；</p>
</blockquote>
<h2 id="1-新建项目"><a href="#1-新建项目" class="headerlink" title="1. 新建项目"></a>1. 新建项目</h2><p>新建一个基于对话框项目“day18”，布局如下，自行处理：<br><img src="http://img.blog.csdn.net/20171104224025288?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="2-新建类Cday18Dlg成员变量"><a href="#2-新建类Cday18Dlg成员变量" class="headerlink" title="2. 新建类Cday18Dlg成员变量"></a>2. 新建类Cday18Dlg成员变量</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">HCURSOR m_hCursor;  //定义一个鼠标的指针</div><div class="line">RECT m_rtCtrl;      //图标的大小</div><div class="line">BOOL m_bCapturing;   //鼠标捕获</div><div class="line">HWND m_hWndDest;   //目标窗口的窗口句柄</div></pre></td></tr></table></figure>
<h2 id="3-加载鼠标指针及获取图标大小"><a href="#3-加载鼠标指针及获取图标大小" class="headerlink" title="3.加载鼠标指针及获取图标大小"></a>3.加载鼠标指针及获取图标大小</h2><p>编辑Cday18Dlg::OnInitDialog()初始化函数，在return之前添加如下两行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">m_hCursor = LoadCursor(NULL, IDC_SIZEALL);</div><div class="line">GetDlgItem(IDC_PIC)-&gt;GetWindowRect(&amp;m_rtCtrl);</div></pre></td></tr></table></figure>
<h2 id="4-创建鼠标右键点击及释放消息"><a href="#4-创建鼠标右键点击及释放消息" class="headerlink" title="4.创建鼠标右键点击及释放消息"></a>4.创建鼠标右键点击及释放消息</h2><p>如图，添加OnLButtonDown及OnLButtonUp消息处理函数：<br><img src="http://img.blog.csdn.net/20171104225220222?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>编辑OnLButtonDown及OnLButtonUp消息处理函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">void Cday18Dlg::OnLButtonDown(UINT nFlags, CPoint point)</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加消息处理程序代码和/或调用默认值</div><div class="line">	if (point.x &gt;= m_rtCtrl.left </div><div class="line">		&amp;&amp; point.x &lt;= m_rtCtrl.right </div><div class="line">		|| point.y &gt;= m_rtCtrl.top </div><div class="line">		&amp;&amp; point.y &lt;= m_rtCtrl.bottom)</div><div class="line">	&#123;</div><div class="line">		m_bCapturing = TRUE;</div><div class="line">		SetCapture(); // 开始捕获鼠标</div><div class="line">		SetCursor(m_hCursor);</div><div class="line">	&#125;</div><div class="line">	CDialogEx::OnLButtonDown(nFlags, point);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<p>1.判断鼠标点击的位置是否在图标上；<br>2.若是，则将开始捕获鼠标标志置位真，并且开始捕获鼠标位置；<br>3.将捕获的鼠标位置设置到成员变量m_hCursor；</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">void Cday18Dlg::OnLButtonUp(UINT nFlags, CPoint point)</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加消息处理程序代码和/或调用默认值</div><div class="line">	if (m_bCapturing)</div><div class="line">	&#123;</div><div class="line">		ReleaseCapture();</div><div class="line">		m_bCapturing = FALSE;</div><div class="line">		POINT pt = point;</div><div class="line">		ClientToScreen(&amp;pt);</div><div class="line">		m_hWndDest = ::WindowFromPoint(pt);</div><div class="line">		TCHAR szBuf[MAX_PATH] = &#123;0&#125;;</div><div class="line">		_stprintf(szBuf,_T(&quot;0x%.8X&quot;),m_hWndDest);</div><div class="line">		SetDlgItemText(IDC_EDIT_DESTHWND,szBuf);</div><div class="line">		GetClassName(m_hWndDest,szBuf,MAX_PATH);</div><div class="line">		SetDlgItemText(IDC_EDIT_DESTCLASS,szBuf);</div><div class="line">		::SendMessage(m_hWndDest,WM_GETTEXT,MAX_PATH,(LPARAM)szBuf);</div><div class="line"></div><div class="line">		SetDlgItemText(IDC_EDIT_DESTTEXT,szBuf);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	CDialogEx::OnLButtonUp(nFlags, point);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<p>1.判断是否在捕获鼠标；<br>2.若是，释放鼠标捕获，获取当前鼠标的位置；<br>3.通过当前鼠标的位置获取到当前位置的窗口句柄；<br>4.分别获取该窗口的句柄，类名，标题；</p>
</blockquote>
<p>效果图：<br><img src="http://img.blog.csdn.net/20171104230232355?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br><img src="http://img.blog.csdn.net/20171104230242358?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="5-实现修改目标窗口标题"><a href="#5-实现修改目标窗口标题" class="headerlink" title="5.实现修改目标窗口标题"></a>5.实现修改目标窗口标题</h2><p>双击“修改标题”按钮，编辑其clicked方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">void Cday18Dlg::OnBnClickedBtnSettext()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	CString strText;</div><div class="line">	GetDlgItemText(IDC_EDIT_DESTTEXT,strText);</div><div class="line">	::SendMessage(m_hWndDest,WM_SETTEXT,0,(LPARAM)(LPCTSTR)strText);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<p>1.获取文本框中的标题值；<br>2.通过SendMessage方法发送WM_SETTEXT消息修改目标窗口的标题</p>
</blockquote>
<p>效果图：<br><img src="http://img.blog.csdn.net/20171104230641050?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="6-实现关闭目标窗口"><a href="#6-实现关闭目标窗口" class="headerlink" title="6.实现关闭目标窗口"></a>6.实现关闭目标窗口</h2><p>双击“关闭标题”按钮，编辑其clicked方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">void Cday18Dlg::OnBnClickedBtnSettext2()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	::SendMessage(m_hWndDest,WM_CLOSE,0,0);</div><div class="line">	//::PostMessage(m_hWndDest,WM_CLOSE,0,0);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<p>1.通过SendMessage方法发送WM_CLOSE消息来关闭目标窗口；</p>
</blockquote>
<p>上面我们都是使用SendMessage方法来发送消息，其实我们也可以把SendMessage全部替换成PostMessage，我们来看看效果：<br><img src="http://img.blog.csdn.net/20171104231231467?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>我们可以看“窗口标题”获取的值是不对的，这是为什么？我们来看一下获取标题的这段代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">ReleaseCapture();</div><div class="line">m_bCapturing = FALSE;</div><div class="line">POINT pt = point;</div><div class="line">ClientToScreen(&amp;pt);</div><div class="line">m_hWndDest = ::WindowFromPoint(pt);</div><div class="line">TCHAR szBuf[MAX_PATH] = &#123;0&#125;;</div><div class="line">_stprintf(szBuf,_T(&quot;0x%.8X&quot;),m_hWndDest);</div><div class="line">SetDlgItemText(IDC_EDIT_DESTHWND,szBuf);</div><div class="line">GetClassName(m_hWndDest,szBuf,MAX_PATH);</div><div class="line">SetDlgItemText(IDC_EDIT_DESTCLASS,szBuf);</div><div class="line">::PostMessage(m_hWndDest,WM_GETTEXT,MAX_PATH,(LPARAM)szBuf);</div><div class="line">SetDlgItemText(IDC_EDIT_DESTTEXT,szBuf);</div></pre></td></tr></table></figure>
<p>我们看到前面获取窗口句柄，类名都是没问题的，但是到了最后获取标题时出了问题；<br>那是因为PostMessage是不会等待消息的返回结果，发送之后直接往下运行，这时szBuf的值还是前面获取的“窗口类名”，所以导致最后的“窗口标题”内容获取出错，这也很好的证明PostMessage和SendMessage的区别；<br>还有“修改标题”及“关闭窗口”按钮不管是PostMessage和SendMessage方法都不会出错，那是因为我们在这两个按钮方法中都不需要消息的返回值，所以在我们以后的实际使用中一定要考虑清楚需要使用哪种发送消息方法；</p>
<h3 id="动态效果图："><a href="#动态效果图：" class="headerlink" title="动态效果图："></a>动态效果图：</h3><p><img src="http://img.blog.csdn.net/20171104233147214?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>附MFC消息分类及说明：</p>
<h3 id="窗口消息"><a href="#窗口消息" class="headerlink" title="窗口消息"></a>窗口消息</h3><blockquote>
<p>WM_CREATE           创建一个窗口 WM_DESTROY          当一个窗口被破坏时发送 WM_MOVE<br>移动一个窗口 WM_SIZE             改变一个窗口的大小 WM_ACTIVATE<br>一个窗口被激活或失去激活状态 WM_SETFOCUS         一个窗口获得焦点 WM_KILLFOCUS<br>一个窗口失去焦点 WM_ENABLE           一个窗口改变成Enable状态 WM_SETREDRAW<br>设置窗口是否能重画 WM_SETTEXT          应用程序发送此消息来设置一个窗口的文本 WM_GETTEXT<br>应用程序发送此消息来复制对应窗口的文本到缓冲区 WM_GETTEXTLENGTH    得到与一个窗口有关的文本的长度（不包含空字符）<br>WM_PAINT            要求一个窗口重画自己 WM_CLOSE<br>当一个窗口或应用程序要关闭时发送一个信号 WM_QUERYENDSESSION<br>当用户选择结束对话框或程序自己调用ExitWindows函数 WM_QUIT             用来结束程序运行<br>WM_QUERYOPEN        当用户窗口恢复以前的大小位置时，把此消息发送给某个图标 WM_ERASEBKGND<br>当窗口背景必须被擦除时（例在窗口改变大小时） WM_SYSCOLORCHANGE   当系统颜色改变时，发送此消息给所有顶级窗口<br>WM_ENDSESSION       当系统进程发出WM_QUERYENDSESSION消息后，此消息发送给应用程序，通知它对话是否结束<br>WM_SHOWWINDOW       当隐藏或显示窗口是发送此消息给这个窗口 WM_ACTIVATEAPP<br>发此消息给应用程序哪个窗口是激活的，哪个是非激活的 WM_FONTCHANGE       当系统的字体资源库变化时发送此消息给所有顶级窗口<br>WM_TIMECHANGE       当系统的时间变化时发送此消息给所有顶级窗口 WM_CANCELMODE<br>发送此消息来取消某种正在进行的摸态（操作） WM_SETCURSOR<br>如果鼠标引起光标在某个窗口中移动且鼠标输入没有被捕获时，就发消息给某个窗口 WM_MOUSEACTIVATE<br>当光标在某个非激活的窗口中而用户正按着鼠标的某个键发送此消息给当前窗口 WM_CHILDACTIVATE<br>发送此消息给MDI子窗口当用户点击此窗口的标题栏，或当窗口被激活，移动，改变大小 WM_QUEUESYNC<br>此消息由基于计算机的训练程序发送，通过 WH_JOURNALPALYBACK 的 hook 程序分离出用户输入消息<br>WM_GETMINMAXINFO    此消息发送给窗口当它将要改变大小或位置 WM_PAINTICON<br>发送给最小化窗口当它图标将要被重画 WM_ICONERASEBKGND   此消息发送给某个最小化窗口，仅当它在画图标前它的背景必须被重画<br>WM_NEXTDLGCTL       发送此消息给一个对话框程序去更改焦点位置 WM_SPOOLERSTATUS<br>每当打印管理列队增加或减少一条作业时发出此消息 WM_DRAWITEM<br>当button，combobox，listbox，menu的可视外观改变时发送 WM_MEASUREITEM      当button,<br>combo box, list box, list view control, or menu item 被创建时<br>WM_VKEYTOITEM<br>此消息有一个LBS_WANTKEYBOARDINPUT风格的发出给它的所有者来响应WM_KEYDOWN消息 WM_CHARTOITEM<br>此消息由一个LBS_WANTKEYBOARDINPUT风格的列表框发送给他的所有者来响应WM_CHAR消息 WM_SETFONT<br>当绘制文本时程序发送此消息得到控件要用的颜色 WM_GETFONT          应用程序发送此消息得到当前控件绘制文本的字体<br>WM_SETHOTKEY        应用程序发送此消息让一个窗口与一个热键相关连 WM_GETHOTKEY<br>应用程序发送此消息来判断热键与某个窗口是否有关联 WM_QUERYDRAGICON<br>此消息发送给最小化窗口，当此窗口将要被拖放而它的类中没有定义图标，应用程序能返回一个图标或光标的句柄，当用户拖放图标时系统显示这个图标或光标<br>WM_COMPAREITEM      发送此消息来判定 combobox 或 listbox 新增加的项的相对位置<br>WM_COMPACTING       显示内存已经很少了 WM_WINDOWPOSCHANGING<br>发送此消息给那个窗口的大小和位置将要被改变时，来调用 setwindowpos 函数或其它窗口管理函数<br>WM_WINDOWPOSCHANGED 发送此消息给那个窗口的大小和位置已经被改变时，来调用setwindowpos函数或其它窗口管理函数<br>WM_POWER            当系统将要进入暂停状态时发送此消息 WM_COPYDATA<br>当一个应用程序传递数据给另一个应用程序时发送此消息 WM_CANCELJOURNA     当某个用户取消程序日志激活状态，提交此消息给程序<br>WM_NOTIFY           当某个控件的某个事件已经发生或这个控件需要得到一些信息时，发送此消息给它的父窗口<br>WM_INPUTLANGCHANGEREQUEST  当用户选择某种输入语言，或输入语言的热键改变 WM_INPUTLANGCHANGE<br>当平台现场已经被改变后发送此消息给受影响的最顶级窗口 WM_TCARD            当程序已经初始化 windows<br>帮助例程时发送此消息给应用程序 WM_HELP<br>此消息显示用户按下了F1，如果某个菜单是激活的，就发送此消息个此窗口关联的菜单，否则就发送给有焦点的窗口，如果当前都没有焦点，就把此消息发送给当前激活的窗口<br>WM_USERCHANGED<br>当用户已经登入或退出后发送此消息给所有的窗口，当用户登入或退出时系统更新用户的具体设置信息，在用户更新设置时系统马上发送此消息<br>WM_NOTIFYFORMAT     公用控件，自定义控件和他们的父窗口通过此消息来判断控件是使用ANSI还是UNICODE结构<br>WM_CONTEXTMENU      当用户某个窗口中点击了一下右键就发送此消息给这个窗口 WM_STYLECHANGING<br>当调用SETWINDOWLONG函数将要改变一个或多个 窗口的风格时发送此消息给那个窗口 WM_STYLECHANGED     当调用<br>SETWINDOWLONG 函数一个或多个 窗口的风格后发送此消息给那个窗口 WM_DISPLAYCHANGE<br>当显示器的分辨率改变后发送此消息给所有的窗口 WM_GETICON<br>此消息发送给某个窗口来返回与某个窗口有关连的大图标或小图标的句柄 WM_SETICON<br>程序发送此消息让一个新的大图标或小图标与某个窗口关联 WM_NCCREATE<br>当某个窗口第一次被创建时，此消息在WM_CREATE消息发送前发送 WM_NCDESTROY<br>此消息通知某个窗口，非客户区正在销毁 WM_NCCALCSIZE       当某个窗口的客户区域必须被核算时发送此消息<br>WM_NCHITTEST        移动鼠标，按住或释放鼠标时发生 WM_NCPAINT<br>程序发送此消息给某个窗口当它（窗口）的框架必须被绘制时 WM_NCACTIVATE<br>此消息发送给某个窗口仅当它的非客户区需要被改变来显示是激活还是非激活状态 WM_GETDLGCODE<br>发送此消息给某个与对话框程序关联的控件。正常情况下，windows 处理所有输入到此控件的箭头键和 TAB 键。通常响应<br>WM_GETDLGCODE 消息，应用程序可以控制一个特定类型的输入和处理这个输入<br>                     WM_NCMOUSEMOVE      当光标在一个窗口的非客户区内移动时发送此消息给这个窗口。非客户区为：窗体的标题栏及窗体的边框 WM_NCLBUTTONDOWN<br>当光标在一个窗口的非客户区同时按下鼠标左键时提交此消息 WM_NCLBUTTONUP<br>当用户释放鼠标左键同时光标某个窗口在非客户区十发送此消息 WM_NCLBUTTONDBLCLK<br>当用户双击鼠标左键同时光标某个窗口在非客户区十发送此消息 WM_NCRBUTTONDOWN<br>当用户按下鼠标右键同时光标又在窗口的非客户区时发送此消息 WM_NCRBUTTONUP<br>当用户释放鼠标右键同时光标又在窗口的非客户区时发送此消息 WM_NCRBUTTONDBLCLK<br>当用户双击鼠标右键同时光标某个窗口在非客户区十发送此消息 WM_NCMBUTTONDOWN<br>当用户按下鼠标中键同时光标又在窗口的非客户区时发送此消息 WM_NCMBUTTONUP<br>当用户释放鼠标中键同时光标又在窗口的非客户区时发送此消息 WM_NCMBUTTONDBLCLK<br>当用户双击鼠标中键同时光标又在窗口的非客户区时发送此消息 WM_KEYFIRST         WM_KEYDOWN 按下一个键<br>WM_KEYUP            释放一个键 WM_CHAR             按下某键，并已发出WM_KEYDOWN，<br>WM_KEYUP消息 WM_DEADCHAR         当用 translatemessage 函数翻译 WM_KEYUP<br>消息时发送此消息给拥有焦点的窗口 WM_SYSKEYDOWN       当用户按住 ALT 键同时按下其它键时提交此消息给拥有焦点的窗口<br>WM_SYSKEYUP         当用户释放一个键同时 ALT 键还按着时提交此消息给拥有焦点的窗口 WM_SYSCHAR<br>当WM_SYSKEYDOWN消息被TRANSLATEMESSAGE函数翻译后提交此消息给拥有焦点的窗口 WM_SYSDEADCHAR<br>当WM_SYSKEYDOWN消息被TRANSLATEMESSAGE函数翻译后发送此消息给拥有焦点的窗口 WM_INITDIALOG<br>在一个对话框程序被显示前发送此消息给它，通常用此消息初始化控件和执行其它任务 WM_COMMAND<br>当用户选择一条菜单命令项或当某个控件发送一条消息给它的父窗口，一个快捷键被翻译 WM_SYSCOMMAND<br>当用户选择窗口菜单的一条命令或当用户选择最大化或最小化时那个窗口会收到此消息 WM_TIMER            发生了定时器事件<br>WM_HSCROLL          当一个窗口标准水平滚动条产生一个滚动事件时发送此消息给那个窗口，也发送给拥有它的控件<br>WM_VSCROLL          当一个窗口标准垂直滚动条产生一个滚动事件时发送此消息给那个窗口，也发送给拥有它的控件<br>WM_INITMENU<br>当一个菜单将要被激活时发送此消息，它发生在用户菜单条中的某项或按下某个菜单键，它允许程序在显示前更改菜单 WM_INITMENUPOPUP<br>当一个下拉菜单或子菜单将要被激活时发送此消息，它允许程序在它显示前更改菜单，而不要改变全部 WM_MENUSELECT<br>当用户选择一条菜单项时发送此消息给菜单的所有者（一般是窗口） WM_MENUCHAR<br>当菜单已被激活用户按下了某个键（不同于加速键），发送此消息给菜单的所有者 WM_ENTERIDLE<br>当一个模态对话框或菜单进入空载状态时发送此消息给它的所有者，一个模态对话框或菜单进入空载状态就是在处理完一条或几条先前的消息后没有消息它的列队中等待<br>WM_CTLCOLORMSGBOX   在 windows<br>绘制消息框前发送此消息给消息框的所有者窗口，通过响应这条消息，所有者窗口可以通过使用给定的相关显示设备的句柄来设置消息框的文本和背景颜色<br>WM_CTLCOLOREDIT     当一个编辑型控件将要被绘制时发送此消息给它的父窗口<br>通过响应这条消息，所有者窗口可以通过使用给定的相关显示设备的句柄来设置编辑框的文本和背景颜色 WM_CTLCOLORLISTBOX<br>当一个列表框控件将要被绘制前发送此消息给它的父窗口<br>通过响应这条消息，所有者窗口可以通过使用给定的相关显示设备的句柄来设置列表框的文本和背景颜色 WM_CTLCOLORBTN<br>当一个按钮控件将要被绘制时发送此消息给它的父窗口 通过响应这条消息，所有者窗口可以通过使用给定的相关显示设备的句柄来设置按纽的文本和背景颜色<br>WM_CTLCOLORDLG      当一个对话框控件将要被绘制前发送此消息给它的父窗口<br>通过响应这条消息，所有者窗口可以通过使用给定的相关显示设备的句柄来设置对话框的文本背景颜色 WM_CTLCOLORSCROLLBAR<br>当一个滚动条控件将要被绘制时发送此消息给它的父窗口 通过响应这条消息，所有者窗口可以通过使用给定的相关显示设备的句柄来设置滚动条的背景颜色<br>WM_CTLCOLORSTATIC   当一个静态控件将要被绘制时发送此消息给它的父窗口 通过响应这条消息，所有者窗口可以<br>通过使用给定的相关显示设备的句柄来设置静态控件的文本和背景颜色 WM_MOUSEFIRST       移动鼠标时发生<br>WM_MOUSEMOVE        移动鼠标时发生，同WM_MOUSEFIRST WM_LBUTTONDOWN      按下鼠标左键<br>WM_LBUTTONUP        释放鼠标左键 WM_LBUTTONDBLCLK    双击鼠标左键 WM_RBUTTONDOWN<br>按下鼠标右键 WM_RBUTTONUP        释放鼠标右键 WM_RBUTTONDBLCLK    双击鼠标右键<br>WM_MBUTTONDOWN      按下鼠标中键 WM_MBUTTONUP        释放鼠标中键 WM_MBUTTONDBLCLK<br>双击鼠标中键 WM_MOUSEWHEEL       当鼠标轮子转动时发送此消息个当前有焦点的控件</p>
</blockquote>
<h3 id="按钮"><a href="#按钮" class="headerlink" title="按钮"></a>按钮</h3><blockquote>
<p>BM_CLICK    按钮被点击消息  BM_GETCHECK 可用于复选框/单选框。查看是否被选择了  BM_GETSTATE<br>发送此消息，可返回 button 的状态，如是否被选择；是否可用（不可用就变灰了）  BM_SETCHECK<br>如果已经选择了，发送此消息后，变为未选择，就是那个钩没被勾上 BM_SETSTATE 设置 button 被点击状态。</p>
</blockquote>
<h3 id="组合框"><a href="#组合框" class="headerlink" title="组合框"></a>组合框</h3><blockquote>
<p>CB_ADDSTRING       添加字符串到组合框。  CB_DELETESTRING    删除组合框中的条目，即 item 。<br>CB_GETCOUNT        得到组合框条目 item 的数目。  CB_GETCURSEL<br>返回组合框中被选条目在组合框中的位置，第一条为 0。<br>                   如果没有条目或出错，则返回 -1 。 CB_GETDROPPEDSTATE 发送此消息，可判断组合框的下拉列表是否下拉。<br>                   如果是，返回非零值，不是，则返回 0 。 CB_GETLBTEXT       得到组合框的条目文本。返回值是这个文本的长度。  CB_GETLBTEXTLEN    返回值是条目的文本的长度。<br>CB_INSERTSTRING    插入字符串条目到组合框中。  CB_RESETCONTENT    清空组合框所有条目。<br>CB_SETCURSEL       设置组合框被选条目。  CB_SHOWDROPDOWN    让组合框的下拉列表下拉，即显出所有条目。</p>
</blockquote>
<h3 id="编辑框"><a href="#编辑框" class="headerlink" title="编辑框"></a>编辑框</h3><blockquote>
<p>EM_CANUNDO             决定上一次操作是否可以 undo（撤消操作）。如果可以，则可发送 EM_UNDO 消息<br>EM_GETFIRSTVISIBLELINE 在多行控件中，找到最上层的可见的行号。此行号是相对于所有行的。<br>EM_GETPASSWORDCHAR     返回密码框的字符集，即查看密码。  EM_GETSEL<br>返回在可编辑控件中，被选择（高亮选择）的字符集的起点和终点的位置，用 SendMessage 的 wParam<br>参数返回起点位置，lParam 返回终点位置  EM_REPLACESEL<br>用不同的字符串替换可编辑控件中的字符串。如果可编辑控件中没有字符串，则此消息变为添加字符串。如果 wParam 为<br>TRUE，则本次操作允许撤消，FALSE 禁止撤消。  EM_SETPASSWORDCHAR     在可编辑控件中设置密码字符集，即用 *<br>代替  EM_UNDO                发送操作撤消消息。    EM_GETLINE<br>获取编辑控件中输入的文字。 EM_LINEFROMCHAR        检索指定字符索引（索引编号从编辑框的第一个字符开始）所在的行索引<br>EM_LINEINDEX           在多行编辑控件中，检索某行首字符在编辑控件中的索引 EM_ERRSPACE<br>编辑控件不能分配足够的内存来满足特定的要求。<br>                       编辑控件的父窗口通过 WM_COMMAND 消息收到此消息。 EM_LIMITTEXT           设置编辑框用户可输入的最大字符数。wParam 为字符数，lParam 不使用(0L)</p>
</blockquote>
<h3 id="IP-地址控件"><a href="#IP-地址控件" class="headerlink" title="IP 地址控件"></a>IP 地址控件</h3><blockquote>
<p>IPM_CLEARADDRESS       清除 IP 地址控件（IP Address control）的内容<br>IPM_GETADDRESS         从 IP 地址控件获得存储在它中的 IP 地址信息 IPM_ISBLANK<br>决定 IP 地址控件是否可以为空值。即 127.0.0.1 之类的地址为空  IPM_SETADDRESS         在 IP<br>地址控件中设置 IP 地址     IPM_SETFOCUS           在 IP 地址控件中，当需要输入 IP 地址时，<br>使之获得键盘输入焦点  IPM_SETRANGE           设置输入 IP 地址的有效范围</p>
</blockquote>
<h3 id="MCI（Media-Control-Interface"><a href="#MCI（Media-Control-Interface" class="headerlink" title="MCI（Media Control Interface)"></a>MCI（Media Control Interface)</h3><blockquote>
<p>MM_MCINOTIFY           该 MM_MCINOTIFY 消息通知应用程序，一个 MCI 设备已完成操作。只有设置了<br>MCI_NOTIFY 标志时，MCI 设备才发送此消息。</p>
</blockquote>
<h3 id="菜单"><a href="#菜单" class="headerlink" title="菜单"></a>菜单</h3><blockquote>
<p>WM_COMMAND     当用户选择菜单中的项目后,将向窗体发送此消息. 窗体收到此消息后,再决定下一个行为。 WM_INITMENU<br>当菜单准备显示前,向窗体发送此消息, 窗体将初始化菜单项。  WM_SYSCOMMAND  向窗体发送用户点击系统菜单消息.<br>窗体将响应这个消息 ,决定下个行为。</p>
</blockquote>
<h3 id="列表框"><a href="#列表框" class="headerlink" title="列表框"></a>列表框</h3><blockquote>
<p>LB_ADDSTRING        在条目中添加字符串  LB_DELETESTRING     删除一个条目. 条目序号是从 0<br>开始的.  LB_GETCOUNT         得到条目总数.  LB_GETCURSEL        得到单选的列表框选项条目的序号<br>LB_GETSEL           判断列表框的条目是否被选上, 如果选上了,则返回 &gt;0 的值。否则返回 0 ,表示用户没选择条目<br>LB_GETSELCOUNT      获得可多选的列表框中被选择的条目数  LB_GETSELITEMS<br>返回可多选的列表框中被选条目的序号，可返回数组 LB_GETTEXT          得到列表框中的一个条目的文本<br>LB_GETTEXTLEN       得到列表框中的一个条目的文本的长度  LB_INSERTSTRING<br>在列表框中插入一个条目。如果成功，将返回插入后此条目的序号。  LB_SETCURSEL<br>对单选的列表框，设定用户选择条目的具体值  LB_SETSEL           对多选的列表框，设定用户选择条目的具体值<br>LB_RESETCONTENT     从列表框删除所有项目，wParam 和 lParam 参数均不使用（为 0）<br>LB_SETHORIZONTALEXTENT<br>设定列表框水平滚动范围。如果列表框宽度小于此值，则水平滚动条显现；如果列表框宽度大于等于此值，则水平滚动条是隐藏的。wParam<br>为所设的水平滚动范围（像素），lParam 不使用，为 0。没有返回值 注意：LB_SETHORIZONTALEXTENT<br>消息要起作用，列表框必须定义 WS_HSCROLL 样式 LB_SETTABSTOPS<br>在列表框中设置制表位位置（即每列间距）为了应对 LB_SETTABSTOPS 消息，列表框必须已经拥有 LBS_USETABSTOPS<br>样式。 wParam 指定制表位数量，lParam 为制表位整数数组（各列之间间隔，不必相等）如果 wParam 是 0，lParam 为<br>NULL，默认制表位是 2 个对话框模板单位。如果 wParam 是 1，制表位为 lParam 指定的距离。如果超过 1，制表位将被设置为<br>lParam 中的每个值（wParam 指定数量）</p>
</blockquote>
<h3 id="鼠标"><a href="#鼠标" class="headerlink" title="鼠标"></a>鼠标</h3><blockquote>
<p>WM_LBUTTONDBLCLK  当鼠标在一个窗体范围内时，告诉此窗体鼠标左键已双击，返回值 0  WM_LBUTTONDOWN<br>当鼠标在一个窗体范围内时，告诉此窗体鼠标左键已点击，返回值 0  WM_LBUTTONUP<br>当鼠标在一个窗体范围内时，告诉此窗体鼠标左键已释放，返回值 0   WM_MBUTTONDBLCLK<br>当鼠标在一个窗体范围内时，告诉此窗体鼠标中键已双击，返回值 0  WM_MBUTTONDOWN<br>当鼠标在一个窗体范围内时，告诉此窗体鼠标中键已点击，返回值 0  WM_MBUTTONUP<br>当鼠标在一个窗体范围内时，告诉此窗体鼠标中键已释放，返回值 0</p>
</blockquote>
<h3 id="项目源码可以访问我的码云"><a href="#项目源码可以访问我的码云" class="headerlink" title="项目源码可以访问我的码云"></a><a href="https://gitee.com/AmuUncle/MFC_CSDN.git" target="_blank" rel="external">项目源码可以访问我的码云</a></h3><h3 id="gt-gt-gt-我的私人博客-lt-lt-lt"><a href="#gt-gt-gt-我的私人博客-lt-lt-lt" class="headerlink" title="&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;"></a><a href="http://amuuncle.site/">&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;</a></h3>
          
        
      
    </div>
    
    
    
	
	
    

    

    
	

	
	<div>
		
	</div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://amuuncle.site/2017/11/02/第15节-MFC之复选框及单选按钮/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="阿木大叔">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ip.freep.cn/593194/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AmuUncle">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/02/第15节-MFC之复选框及单选按钮/" itemprop="url">第15节 MFC之复选框及单选按钮</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-02T23:00:09+08:00">
                2017-11-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MFC从入门到放弃/" itemprop="url" rel="index">
                    <span itemprop="name">MFC从入门到放弃</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Windows编程基础–第15节-MFC之复选框及单选按钮"><a href="#Windows编程基础–第15节-MFC之复选框及单选按钮" class="headerlink" title="Windows编程基础–第15节 MFC之复选框及单选按钮"></a>Windows编程基础–第15节 MFC之复选框及单选按钮</h1><h2 id="1-新建项目"><a href="#1-新建项目" class="headerlink" title="1. 新建项目"></a>1. 新建项目</h2><p>新建一个基于对话框项目“day17”，布局如下，自行处理：<br><img src="http://img.blog.csdn.net/20171102215604038?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>拖动三个check box和两个radio button到界面上，设置其ID如下：<br>| 控件名 | 控件ID|<br>| ——–   |  —–:  |<br>| 红色| IDC_CHECK_RED|<br>| 绿色   |   IDC_CHECK_GREEN|<br>| 蓝色     |   IDC_CHECK_BLUE|<br>| 矩形      |   IDC_RADIO_SQURAE|<br>| 圆形|   IDC_RADIO_CIRC|<br>执行“工具”-&gt;“tab键位置”，确保两个radio button的顺序是连续的，如下图：<br><img src="http://img.blog.csdn.net/20171102220353696?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br><img src="http://img.blog.csdn.net/20171102220403509?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>指定第一个radio button（矩形）的Group的值为true，如图:<br><img src="http://img.blog.csdn.net/20171102220705649?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="2-添加关联变量"><a href="#2-添加关联变量" class="headerlink" title="2. 添加关联变量"></a>2. 添加关联变量</h2><p>添加五个控件的变量，如图：<br><img src="http://img.blog.csdn.net/20171102221631588?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">DDX_Control(pDX, IDC_CHECK_RED, m_chk_red);</div><div class="line">DDX_Control(pDX, IDC_CHECK_GREEN, m_chk_green);</div><div class="line">DDX_Control(pDX, IDC_CHECK_BLUE, m_chk_blue);</div><div class="line">DDX_Control(pDX, IDC_RADIO_SQURAE, m_rd_squ);</div><div class="line">DDX_Control(pDX, IDC_RADIO_CIRC, m_rd_circ);</div></pre></td></tr></table></figure>
<p>分别添加如上变量；</p>
<h2 id="3-开始写代码吧"><a href="#3-开始写代码吧" class="headerlink" title="3. 开始写代码吧"></a>3. 开始写代码吧</h2><p>现在我们来让程序运行起来时默认选中圆形；<br>切换到解决方案视图，进入BOOL Cday17Dlg::OnInitDialog()方法：<br>在末尾return前加入这一行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// TODO: 在此添加额外的初始化代码</div><div class="line">CheckRadioButton(IDC_RADIO_SQURAE,IDC_RADIO_CIRC,IDC_RADIO_CIRC);</div><div class="line"></div><div class="line">return TRUE;  // 除非将焦点设置到控件，否则返回 TRUE</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<p>在IDC_RADIO_SQURAE和IDC_RADIO_CIRC之间选中IDC_RADIO_CIRC</p>
</blockquote>
<h2 id="添加五个控件的事件处理方法"><a href="#添加五个控件的事件处理方法" class="headerlink" title="添加五个控件的事件处理方法"></a>添加五个控件的事件处理方法</h2><p>如图所示：<br><img src="http://img.blog.csdn.net/20171102224705375?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>剩下四个都如上添加好；<br>编辑“蓝色”按钮的点击方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">void Cday17Dlg::OnBnClickedCheckBlue()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	Invalidate();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<p>Invalidate()让对话框重汇对话框；</p>
<h2 id="添加擦除背景消息（OnEraseBkgnd）事件"><a href="#添加擦除背景消息（OnEraseBkgnd）事件" class="headerlink" title="添加擦除背景消息（OnEraseBkgnd）事件"></a>添加擦除背景消息（OnEraseBkgnd）事件</h2><p>如图添加OnEraseBkgnd消息处理函数：<br><img src="http://img.blog.csdn.net/20171102225056653?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>编辑OnEraseBkgnd函数：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">BOOL Cday17Dlg::OnEraseBkgnd(CDC* pDC)</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加消息处理程序代码和/或调用默认值</div><div class="line">	BOOL bRet = CDialogEx::OnEraseBkgnd(pDC);</div><div class="line">	int nRed,nGreen,nBlue;</div><div class="line">	nRed = m_chk_red.GetCheck() ? 255 : 0;</div><div class="line">	nGreen = m_chk_green.GetCheck() ? 255 : 0;</div><div class="line">	nBlue = m_chk_blue.GetCheck() ? 255 : 0;</div><div class="line"></div><div class="line">	COLORREF crFore = RGB(nRed,nGreen,nBlue);</div><div class="line">	CBrush brush;</div><div class="line">	brush.CreateSolidBrush(crFore);</div><div class="line">	CBrush *pOldBrush = pDC-&gt;SelectObject(&amp;brush);</div><div class="line"></div><div class="line">	RECT rc = &#123;100, 40, 400, 340&#125;;</div><div class="line">	if (m_rd_squ.GetCheck())</div><div class="line">	&#123;</div><div class="line">		pDC-&gt;Rectangle(&amp;rc);</div><div class="line">	&#125;</div><div class="line">	else&#123;</div><div class="line">		pDC-&gt;Ellipse(&amp;rc);</div><div class="line">	&#125;</div><div class="line">	pDC-&gt;SelectObject(pOldBrush);</div><div class="line">	return bRet;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<ol>
<li>根据颜色按钮的选择状态来选择颜色为255还是0；</li>
<li>用三个的颜色来创建一个画刷；</li>
<li>保留旧的画刷；</li>
<li>创建RECT 对象，即圆形的大小；</li>
<li>根据形状的radio button来选择化圆形还是矩形；</li>
<li>还原旧的画刷；</li>
</ol>
</blockquote>
<h2 id="实现其他按钮"><a href="#实现其他按钮" class="headerlink" title="实现其他按钮"></a>实现其他按钮</h2><p>其他按钮就只用调用OnBnClickedCheckBlue()就可以了；</p>
<h1 id="最终效果图："><a href="#最终效果图：" class="headerlink" title="最终效果图："></a>最终效果图：</h1><p><img src="http://img.blog.csdn.net/20171102225829436?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h3 id="项目源码可以访问我的码云"><a href="#项目源码可以访问我的码云" class="headerlink" title="项目源码可以访问我的码云"></a><a href="https://gitee.com/AmuUncle/MFC_CSDN.git" target="_blank" rel="external">项目源码可以访问我的码云</a></h3><h3 id="gt-gt-gt-我的私人博客-lt-lt-lt"><a href="#gt-gt-gt-我的私人博客-lt-lt-lt" class="headerlink" title="&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;"></a><a href="http://amuuncle.site/">&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;</a></h3>
          
        
      
    </div>
    
    
    
	
	
    

    

    
	

	
	<div>
		
	</div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://amuuncle.site/2017/11/01/第14节-MFC之文件对话框CFileDialog/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="阿木大叔">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ip.freep.cn/593194/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AmuUncle">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/11/01/第14节-MFC之文件对话框CFileDialog/" itemprop="url">第14节 MFC之文件对话框CFileDialog</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-01T21:49:20+08:00">
                2017-11-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MFC从入门到放弃/" itemprop="url" rel="index">
                    <span itemprop="name">MFC从入门到放弃</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="第14节-MFC之文件对话框CFileDialog"><a href="#第14节-MFC之文件对话框CFileDialog" class="headerlink" title="第14节 MFC之文件对话框CFileDialog"></a>第14节 MFC之文件对话框CFileDialog</h1><hr>
<p>今天我们学习两个打开文件对话框、保存文件对话框，应用程序难免需要加载文件，或者打开配置文件等，这就用到打开或者保存对话框，例如windows文本编辑器中保存对话框就属于其中一种：<br><img src="http://img.blog.csdn.net/20171101203217131?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<hr>
<h2 id="1-新建项目"><a href="#1-新建项目" class="headerlink" title="1. 新建项目"></a>1. 新建项目</h2><p>新建一个基于对话框项目“day16”，布局如下，自行处理：<br><img src="http://img.blog.csdn.net/20171101203650950?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>拖动一个EDIT到界面，并修改如下属性：</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>修改值</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>ID</td>
<td>IDC_EDIT_TXT</td>
<td>控件ID</td>
</tr>
<tr>
<td>Want Return</td>
<td>TRUE</td>
<td>允许回车</td>
</tr>
<tr>
<td>Multiline</td>
<td>TRUE</td>
<td>允许多行</td>
</tr>
<tr>
<td>Horizontal Scoll</td>
<td>TRUE</td>
<td>水平滚动条</td>
</tr>
<tr>
<td>Vertical Scoll</td>
<td>TRUE</td>
<td>垂直滚动条</td>
</tr>
</tbody>
</table>
<h2 id="2-添加菜单资源"><a href="#2-添加菜单资源" class="headerlink" title="2. 添加菜单资源"></a>2. 添加菜单资源</h2><p>切换到资源视图，添加菜单资源如下：<br><img src="http://img.blog.csdn.net/20171101204453007?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>若不知道怎么添加菜单请参考<a href="http://blog.csdn.net/qq_25549309/article/details/78359647" target="_blank" rel="external"><strong>Windows编程基础–第10节 MFC菜单 </strong></a></p>
<blockquote>
<p>注意：菜单选项最后加上&amp;符号可以设置快捷键，如“文件(&amp;F)”，当程序运行时可以通过ALT + F快捷打开文件菜单选项；</p>
</blockquote>
<p>将菜单绑定到主界面：<br><img src="http://img.blog.csdn.net/20171101204853878?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="3-实现文件打开对话框"><a href="#3-实现文件打开对话框" class="headerlink" title="3. 实现文件打开对话框"></a>3. 实现文件打开对话框</h2><p>右击菜单中“打开”选项，选择“添加事件处理处理程序”，添加处理程序，如图：<br><img src="http://img.blog.csdn.net/20171101205350070?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述">其中行数处理程序名称：OnFileOpen，类列表选择：Cday16Dlg，添加编辑：<br>函数代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">void Cday16Dlg::OnFileOpen()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加命令处理程序代码</div><div class="line">	CFileDialog dlg(TRUE,NULL,NULL,OFN_FILEMUSTEXIST|OFN_PATHMUSTEXIST,_T(&quot;文本文件(*.txt)|*.txt|所有文件(*.*)|*.*||&quot;),this);</div><div class="line">	dlg.m_ofn.lpstrInitialDir = _T(&quot;C:\\&quot;);</div><div class="line">	if (dlg.DoModal()  == IDOK)</div><div class="line">	&#123;</div><div class="line">		CStdioFile inFile;</div><div class="line">		inFile.Open(dlg.GetPathName(),CFile::modeRead);</div><div class="line">		CString text;</div><div class="line">		CString temp;</div><div class="line">		while(inFile.ReadString(text))</div><div class="line">		&#123;    </div><div class="line">			GetDlgItemText(IDC_EDIT_TXT,temp);</div><div class="line">			if (temp.GetLength() &gt; 0)</div><div class="line">			&#123;</div><div class="line">				SetDlgItemText(IDC_EDIT_TXT,temp +&quot;\r\n&quot;+ text);</div><div class="line">			&#125;</div><div class="line">			else</div><div class="line">			&#123;</div><div class="line">				SetDlgItemText(IDC_EDIT_TXT,text);</div><div class="line">			&#125;</div><div class="line">			</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		inFile.Close();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<ol>
<li>创建一个txt文件对话框；</li>
<li>如文件对话框确定按钮被点击，则打开文件位置，文件全路径就是dlg.GetPathName()；</li>
<li>循环读取文件，知道文件读取结束；每读一行就先获取界面文本框的内容加上新读取的文本，重新设置到界面；</li>
<li>关闭文件</li>
</ol>
</blockquote>
<p>这样一个打开文件对话框就完成了，效果图如下：<br><img src="http://img.blog.csdn.net/20171101213305582?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="3-实现文件保存对话框"><a href="#3-实现文件保存对话框" class="headerlink" title="3. 实现文件保存对话框"></a>3. 实现文件保存对话框</h2><p>右击菜单中“保存”选项，选择“添加事件处理处理程序”，添加处理程序，如图：<br><img src="http://img.blog.csdn.net/20171101213433187?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>名称：OnSaveFile，类列表选择：Cday16Dlg，添加编辑：<br>函数代码如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">void Cday16Dlg::OnSaveFile()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加命令处理程序代码</div><div class="line">	CFileDialog dlg(FALSE,NULL,NULL,OFN_HIDEREADONLY |OFN_OVERWRITEPROMPT | OFN_PATHMUSTEXIST,_T(&quot;文本文件(*.txt)|*.txt||&quot;),this);</div><div class="line">	if (dlg.DoModal()  == IDOK)</div><div class="line">	&#123;</div><div class="line">		CFile file;  //建立一个CFile对象</div><div class="line">		//打开文件,如果不存在该文件就创建文件</div><div class="line">		if(!file.Open(dlg.GetPathName(),CFile::modeCreate|CFile::modeWrite))</div><div class="line">		&#123;</div><div class="line">			AfxMessageBox( &quot;can   not   Create   file! &quot;);</div><div class="line">			return;</div><div class="line">		&#125; </div><div class="line"></div><div class="line">		CString output;</div><div class="line">		GetDlgItemText(IDC_EDIT_TXT,output);</div><div class="line">		file.Write(output,strlen(output));</div><div class="line">		file.Flush();    //将在缓冲区中的字符写入文件中</div><div class="line">		file.Close();   //关闭文件</div><div class="line">		AfxMessageBox( &quot;保存成功！&quot;);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>代码解释：</p>
<blockquote>
<ol>
<li>创建一个txt文件保存对话框；</li>
<li>如文件对话框确定按钮被点击，则获取文件位置，文件全路径就是dlg.GetPathName()；</li>
<li>先获取界面文本框的内容，将内容写到文件中；</li>
<li>关闭文件<br>效果图：<br><img src="http://img.blog.csdn.net/20171101214549676?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></li>
</ol>
</blockquote>
<h2 id="好了，这节我们演示了如何创建文件打开和保存对话框，希望对大家有作用，今天就到这了。"><a href="#好了，这节我们演示了如何创建文件打开和保存对话框，希望对大家有作用，今天就到这了。" class="headerlink" title="好了，这节我们演示了如何创建文件打开和保存对话框，希望对大家有作用，今天就到这了。"></a>好了，这节我们演示了如何创建文件打开和保存对话框，希望对大家有作用，今天就到这了。</h2><h3 id="项目源码可以访问我的码云"><a href="#项目源码可以访问我的码云" class="headerlink" title="项目源码可以访问我的码云"></a><a href="https://gitee.com/AmuUncle/MFC_CSDN.git" target="_blank" rel="external">项目源码可以访问我的码云</a></h3><h3 id="gt-gt-gt-我的私人博客-lt-lt-lt"><a href="#gt-gt-gt-我的私人博客-lt-lt-lt" class="headerlink" title="&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;"></a><a href="http://blog.amuuncle.site/" target="_blank" rel="external">&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;</a></h3>
          
        
      
    </div>
    
    
    
	
	
    

    

    
	

	
	<div>
		
	</div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://amuuncle.site/2017/10/31/第13节-MFC之图片控件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="阿木大叔">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ip.freep.cn/593194/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AmuUncle">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/31/第13节-MFC之图片控件/" itemprop="url">第13节 MFC之图片控件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-31T22:37:27+08:00">
                2017-10-31
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MFC从入门到放弃/" itemprop="url" rel="index">
                    <span itemprop="name">MFC从入门到放弃</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="第13节-MFC之图片控件"><a href="#第13节-MFC之图片控件" class="headerlink" title="第13节 MFC之图片控件"></a>第13节 MFC之图片控件</h1><p>这节学习两个控件：</p>
<blockquote>
<p>图片控件：  Picture Control</p>
</blockquote>
<h2 id="1-新建项目"><a href="#1-新建项目" class="headerlink" title="1. 新建项目"></a>1. 新建项目</h2><p>新建一个基于对话框项目“day15”，布局如下，自行处理：<br><img src="http://img.blog.csdn.net/20171031214935166?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>拖动一个<strong>Picture Control</strong>控件到界面，其实Picture Control就是CStatic 类；</p>
<p>设置<strong>Picture Control</strong>的如下属性：</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>修改值</th>
<th style="text-align:right">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>ID</td>
<td>IDC_STATIC_IMG</td>
<td style="text-align:right">控件ID</td>
</tr>
<tr>
<td>Type</td>
<td>Bitmap</td>
<td style="text-align:right">设置类型为bitmap位图类型</td>
</tr>
</tbody>
</table>
<p>如图：<img src="http://img.blog.csdn.net/20171031215325005?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="2-添加Bitmap-位图资源"><a href="#2-添加Bitmap-位图资源" class="headerlink" title="2.添加Bitmap 位图资源"></a>2.添加Bitmap 位图资源</h2><p>自行下载几张.bmp位图，拷贝到项目的res文件下，然后切换到资源视图，添加Bitmap 资源，如图所示：<br><img src="http://img.blog.csdn.net/20171031220313389?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br><img src="http://img.blog.csdn.net/20171031220321254?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br><img src="http://img.blog.csdn.net/20171031220331105?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>上传完成之后可以看到已经有三个Bitmap 位图的ID；<br><img src="http://img.blog.csdn.net/20171031220405693?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="3-显示出位图资源"><a href="#3-显示出位图资源" class="headerlink" title="3.显示出位图资源"></a>3.显示出位图资源</h2><p>单击<strong>Picture Control</strong>控件，在属性中找到Image属性，在下拉框中选择我们刚才添加的位图ID就可以成功显示图片了，如图：<br><img src="http://img.blog.csdn.net/20171031220811037?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="4-动态控制显示图片"><a href="#4-动态控制显示图片" class="headerlink" title="4.动态控制显示图片"></a>4.动态控制显示图片</h2><p>在界面上添加一个按钮，我么通过按钮来切换界面图片显示：<br><img src="http://img.blog.csdn.net/20171031221205220?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>接下来我们添加<strong>Picture Control</strong>控件的变量m_image，如图:<br><img src="http://img.blog.csdn.net/20171031221246177?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>我们来编辑“切换按钮”的点击方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">void Cday15Dlg::OnBnClickedButtonChange()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	HBITMAP phBmp = (HBITMAP)LoadImage(NULL,_T(&quot;.\\res\\20171031100114614.bmp&quot;),IMAGE_BITMAP,0,0,LR_LOADFROMFILE);</div><div class="line">	m_image.SetBitmap(phBmp);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<ol>
<li>获取一个位图的句柄<br>2.将其设置到<strong>Picture Control</strong>控件</li>
</ol>
</blockquote>
<p>效果图：<br><img src="http://img.blog.csdn.net/20171031222147848?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="5-配合CFileDialog-类来选择显示图片"><a href="#5-配合CFileDialog-类来选择显示图片" class="headerlink" title="5.配合CFileDialog 类来选择显示图片"></a>5.配合CFileDialog 类来选择显示图片</h2><p>我们来编辑“切换按钮”的点击方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">void Cday15Dlg::OnBnClickedButtonChange()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	CFileDialog dlg(TRUE,NULL,NULL,OFN_FILEMUSTEXIST,_T(&quot;*.bmp|*.bmp&quot;),this);</div><div class="line">	if (dlg.DoModal() == IDOK)</div><div class="line">	&#123;</div><div class="line">		HBITMAP phBmp = (HBITMAP)LoadImage(NULL,dlg.GetPathName(),IMAGE_BITMAP,0,0,LR_LOADFROMFILE);</div><div class="line">		m_image.SetBitmap(phBmp);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<ol>
<li>创建一个.bmp类型的文件打开对话框</li>
<li>若点击确定按钮，则将选择的.bmp文件显示出来；</li>
</ol>
</blockquote>
<p>效果图：<br><img src="http://img.blog.csdn.net/20171031223111658?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>附<strong>Picture Control</strong>控件常见属性及方法：</p>
<h3 id="一、图片控件属性"><a href="#一、图片控件属性" class="headerlink" title="一、图片控件属性"></a>一、图片控件属性</h3><blockquote>
<p>Picture Control 属性: Type:Frame //框架 Type:Etched Horz水平蚀刻线条 Type:Etched<br>Vert垂真蚀刻线条 Type:Rectangle实心矩形 Type:Bitmap位图 Type:Icon  图标<br>Type:Enhanced Metafile 增强图元 支持wmf格式图片 Type:Owner Draw   自绘图 Color:颜色<br>    Black:黑<br>    Gray:灰色<br>    White:白色<br>    Etched:蚀刻</p>
</blockquote>
<h3 id="二、Picture-Control-控件类"><a href="#二、Picture-Control-控件类" class="headerlink" title="二、Picture Control 控件类"></a>二、Picture Control 控件类</h3><blockquote>
<p>CStatic:: SetBitmap Specifies a bitmap to be displayed in the static<br>control. GetBitmap Retrieves the handle of the bitmap previously set<br>with SetBitmap.</p>
<p>SetIcon Specifies an icon to be displayed in the static control.<br>GetIcon Retrieves the handle of the icon previously set with SetIcon.</p>
<p>SetCursor Specifies a cursor image to be displayed in the static<br>control. GetCursor Retrieves the handle of the cursor image previously<br>set with SetCursor.</p>
<p>SetEnhMetaFile Specifies an enhanced metafile to be displayed in the<br>static control. GetEnhMetaFile Retrieves the handle of the enhanced<br>metafile previously set with SetEnhMetaFile</p>
</blockquote>
<h3 id="项目源码可以访问我的码云"><a href="#项目源码可以访问我的码云" class="headerlink" title="项目源码可以访问我的码云"></a><a href="https://gitee.com/AmuUncle/MFC_CSDN.git" target="_blank" rel="external">项目源码可以访问我的码云</a></h3><h3 id="gt-gt-gt-我的私人博客-lt-lt-lt"><a href="#gt-gt-gt-我的私人博客-lt-lt-lt" class="headerlink" title="&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;"></a><a href="http://blog.amuuncle.site/" target="_blank" rel="external">&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;</a></h3>
          
        
      
    </div>
    
    
    
	
	
    

    

    
	

	
	<div>
		
	</div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://amuuncle.site/2017/10/30/第12节-MFC之树控件CTreeCtrl/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="阿木大叔">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ip.freep.cn/593194/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AmuUncle">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/30/第12节-MFC之树控件CTreeCtrl/" itemprop="url">第12节 MFC之树控件CTreeCtrl</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-30T21:42:36+08:00">
                2017-10-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MFC从入门到放弃/" itemprop="url" rel="index">
                    <span itemprop="name">MFC从入门到放弃</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>树形控件（Tree Control）：用来显示一系列项目的层次关系，最典型的例子是显示磁盘上的文件与文件夹。如果有子项目的话，单击树形控件中的项目可以展开或者收缩其子项目。MFC提供了CTreeCtrl类进行支持。</p>
</blockquote>
<p>树控件在windows程序中使用相对也是比较多的控件，例如windows资源管理器左边的浏览视图就是个树控件视图：<br><img src="http://img.blog.csdn.net/20171030202704102?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>今天我们学习一下使用树控件，实现“添加节点”、“删除节点”、“修改节点”；</p>
<h2 id="1-新建项目"><a href="#1-新建项目" class="headerlink" title="1. 新建项目"></a>1. 新建项目</h2><p>新建一个基于对话框项目“day14”，布局如下，自行处理：<br><img src="http://img.blog.csdn.net/20171030203600767?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<table>
<thead>
<tr>
<th>控件名</th>
<th style="text-align:right">控件ID</th>
</tr>
</thead>
<tbody>
<tr>
<td>Tree Control</td>
<td style="text-align:right">IDC_TREE_VIEW</td>
</tr>
<tr>
<td>编辑框</td>
<td style="text-align:right">IDC_EDIT_ADD_MDY</td>
</tr>
<tr>
<td>添加节点</td>
<td style="text-align:right">IDC_BUTTON_ADD</td>
</tr>
<tr>
<td>删除节点</td>
<td style="text-align:right">IDC_BUTTON_DEL</td>
</tr>
<tr>
<td>修改节点</td>
<td style="text-align:right">IDC_BUTTON_MDY</td>
</tr>
</tbody>
</table>
<h2 id="2-设置树控件属性"><a href="#2-设置树控件属性" class="headerlink" title="2. 设置树控件属性"></a>2. 设置树控件属性</h2><p>编辑树控件如下属性：</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>修改值</th>
<th style="text-align:right">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>Has Buttons</td>
<td>TRUE</td>
<td style="text-align:right">在父节点旁边显示+或-</td>
</tr>
<tr>
<td>Has Lines</td>
<td>TRUE</td>
<td style="text-align:right">在父节点和子节点之间划线</td>
</tr>
<tr>
<td>Line At root</td>
<td>TRUE</td>
<td style="text-align:right">在根节点上划线</td>
</tr>
</tbody>
</table>
<h2 id="3-添加树控件变量"><a href="#3-添加树控件变量" class="headerlink" title="3. 添加树控件变量"></a>3. 添加树控件变量</h2><p>给树控件添加一个变量“m_tree”，如图：<br><img src="http://img.blog.csdn.net/20171030204858144?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="4-实现添加节点按钮函数"><a href="#4-实现添加节点按钮函数" class="headerlink" title="4. 实现添加节点按钮函数"></a>4. 实现添加节点按钮函数</h2><p>双击“添加节点”按钮，编辑按钮点击方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">void Cday14Dlg::OnBnClickedButtonAdd()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	CString strText;</div><div class="line">	GetDlgItemText(IDC_EDIT_ADD_MDY,strText);</div><div class="line">	if (strText.GetLength() == 0)</div><div class="line">	&#123;</div><div class="line">		AfxMessageBox(_T(&quot;请输入节点名！&quot;));</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	HTREEITEM hItem = m_tree.GetSelectedItem();</div><div class="line">	if(hItem == NULL)&#123;</div><div class="line">		hItem = TVI_ROOT;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	TVINSERTSTRUCT ts =&#123;0&#125;;</div><div class="line">	ts.hParent = hItem;</div><div class="line">	ts.hInsertAfter = TVI_LAST;</div><div class="line">	ts.item.pszText = strText.GetBuffer();</div><div class="line">	ts.item.mask = TVIF_TEXT;</div><div class="line">	HTREEITEM hNewItem = m_tree.InsertItem(&amp;ts);</div><div class="line">	m_tree.SelectItem(hNewItem);</div><div class="line">	m_tree.EnsureVisible(hNewItem);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<ol>
<li>先获取文本框中的值，如果值为空，则提示用户输入；</li>
<li>获取当前选中的节点，若不存在选中的节点，则获取根节点；</li>
<li>创建节点结构体，设置其父节点，插入方式，节点内容，内容可见等；</li>
<li>插入新的节点，并且设置节点保证可见；<br>效果图：<br><img src="http://img.blog.csdn.net/20171030211143052?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><h2 id="5-实现删除节点按钮函数"><a href="#5-实现删除节点按钮函数" class="headerlink" title="5. 实现删除节点按钮函数"></a>5. 实现删除节点按钮函数</h2>双击“删除节点”按钮，编辑按钮点击方法：</li>
</ol>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">void Cday14Dlg::OnBnClickedButtonDel()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	HTREEITEM hItem = m_tree.GetSelectedItem();</div><div class="line">	if(hItem == NULL)&#123;</div><div class="line">		AfxMessageBox(_T(&quot;请选择要删除的节点！&quot;));</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	HTREEITEM hParentItem = m_tree.GetParentItem(hItem);</div><div class="line">	m_tree.DeleteItem(hItem);</div><div class="line">	m_tree.SelectItem(hParentItem);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<ol>
<li>获取选中的节点，若没有选中的节点，则提示用户；</li>
<li>获取选中节点的父节点</li>
<li>删除选中的节点</li>
<li>将其父节点设置为选中节点</li>
</ol>
</blockquote>
<p>删除前：<br><img src="http://img.blog.csdn.net/20171030211100130?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>删除后：<br><img src="http://img.blog.csdn.net/20171030211117156?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="6-实现修改节点按钮函数"><a href="#6-实现修改节点按钮函数" class="headerlink" title="6. 实现修改节点按钮函数"></a>6. 实现修改节点按钮函数</h2><p>双击“修改节点”按钮，编辑按钮点击方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">void Cday14Dlg::OnBnClickedButtonMdy()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	HTREEITEM hItem = m_tree.GetSelectedItem();</div><div class="line">	if(hItem == NULL)&#123;</div><div class="line">		AfxMessageBox(_T(&quot;请选择要修改的节点！&quot;));</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	CString strText;</div><div class="line">	GetDlgItemText(IDC_EDIT_ADD_MDY,strText);</div><div class="line">	if (strText.GetLength() == 0)</div><div class="line">	&#123;</div><div class="line">		AfxMessageBox(_T(&quot;请输入新的节点名！&quot;));</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	m_tree.SetItemText(hItem,strText);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<ol>
<li>获取选中的节点，若没有选中的节点，则提示用户；</li>
<li>先获取文本框中的值，如果值为空，则提示用户输入；<br>3.修改文本名<h2 id="7-映射节点选择消息"><a href="#7-映射节点选择消息" class="headerlink" title="7. 映射节点选择消息"></a>7. 映射节点选择消息</h2>我们想实现在点击选择控件是，下方的文本框中自动出现选择节点的文本，那么就要映射节点的选择变化消息：TVN_SELCHANGE，如图添加事件处理函数：<br><img src="http://img.blog.csdn.net/20171030212609773?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>编辑事件处理函数：</li>
</ol>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">void Cday14Dlg::OnTvnSelchangedTreeView(NMHDR *pNMHDR, LRESULT *pResult)</div><div class="line">&#123;</div><div class="line">	LPNMTREEVIEW pNMTreeView = reinterpret_cast&lt;LPNMTREEVIEW&gt;(pNMHDR);</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line"></div><div class="line">	HTREEITEM hItem = m_tree.GetSelectedItem();</div><div class="line">	if(hItem != NULL)&#123;</div><div class="line">		CString strText = m_tree.GetItemText(hItem);</div><div class="line">		SetDlgItemText(IDC_EDIT_ADD_MDY, strText);</div><div class="line">	&#125;</div><div class="line">	*pResult = 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>代码解释：</p>
<blockquote>
<ol>
<li>获取选中的节点，若不存在，则略过，不处理；</li>
<li>获取选中的节点文本，将文本值设置到文本框中；</li>
</ol>
</blockquote>
<p>效果图：<br><img src="http://img.blog.csdn.net/20171030213448114?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>至此，MFC树控件的简单使用已经结束，其实树控件还有很多属性，比如添加图标，这就到以后的实践中再来学习，附树控件常见属性及方法：</p>
<h3 id="1、树形控件的属性"><a href="#1、树形控件的属性" class="headerlink" title="1、树形控件的属性"></a>1、树形控件的属性</h3><blockquote>
<p>TVS_EDITLABELS:允许用户进行节点文本的编辑 TVS_HASBUTTONS:节点左侧添加一个按钮<br>TVS_HASLINES:父节点与子结点出现连线 TVS_LINESATROOT:子节点与根节点之间出现连线<br>TVS_NOTOOLTIPS:结点无动态提示 TVS_SINGLEEXPAND:节点的选中(未选中)t7展开(合拢)同步<br>MFC中以两种形式封装树形控件，一种是树形控件CTreeCtrl，另一种是树形视图控件CTreeView。对于一般的要求，比如在对话框中，使用CTreeCtrl比较方便。在使用树形视图控件时，只需要利用成员函数取得其引用，就可以像树形控件一样方便的使用：<br>CTreeCtrl&amp; GetTreeCtrl( ) const;<br>调用InsertItem函数能够将节点插入树形控件中，并返回插入的项的HTREEITEM。树形控件的插入工作往往是在对话框的OnInitDialog函数中进行，而对于树形视图控件，则是在OnInitUpdate函数中进行。<br>树形控件中的节点数据可以是文本，也可以是图像。节点中使用的图像是和树形控件的图像列表相对应的。在树形控件中使用图像列表是通过使用SetImageList函数来完成。<br>树形控件能产生通告消息，如: TVN_BEGINDRAG开始拖拽 TVN_ITEMEXPANDED节点被展开或收缩<br>其消息映射使用WM_NOTIFI,如： WM_NOTIFI(TVN_BEGINDRAG,IDC_TREECTRL,OnBeginDrag);</p>
</blockquote>
<h3 id="2、树形控件TVN-BEGINRDRAG消息的响应"><a href="#2、树形控件TVN-BEGINRDRAG消息的响应" class="headerlink" title="2、树形控件TVN_BEGINRDRAG消息的响应"></a>2、树形控件TVN_BEGINRDRAG消息的响应</h3><blockquote>
<p>与树形控件有关的、常用的结构是TVITEM、TVINSERTSTRUCT 、NMTREEVIEW(NM_TREEVIEW<br>)。前两个是用于插入节点时使用，而NMTREEVIEW是与树形控件的通告消息相关的结构。<br>当用鼠标左键拖拽树形控件时，控件会发出TVN_BEGINDRAG通告消息；当用鼠标右键拖拽时，则会发出TVN_BEGINRDRAG通告消息。拖拽树形控件时需要使用到IImageList::BeginDrag函数：<br>IImageList::BeginDrag creates a temporary image list that is used for<br>dragging. In response to subsequent WM_MOUSEMOVE messages, you can<br>move the drag image by using IImageList::DragMove. To end the drag<br>operation, you can use IImageList::EndDrag.<br>通常使用CTreeCtrl::CreateDragImage函数创建一个被拖拽节点的图像并返回一个CImageList指针(注意被拖拽的数据节点必须包含图像，否则返回的CImageList指针为空)，然后利用该指针来调用CImageList::BeginDrag函数。除此之外还需要调用CImageList::DragEnter函数锁定、更新窗口，并在指定的位置显示被拖拽的图像：<br>static BOOL PASCAL DragEnter(    CWnd* pWndLock,    CPoint point  );<br>If pWndLock is NULL, this function draws the image in the display<br>context associated with the desktop window, and coordinates are<br>relative to the upper left corner of the screen.<br>注意BeginDrag函数只是在拖拽开始时创建要拖拽的图像，而DragEnter函数则显示该图像。<br>最后调用CWnd::SetCapture函数使后续所有的鼠标输入都发送到当前的CWnd对象而不管鼠标的位置（因为CImageList::DragEnter函数的第一个参数为NULL时表示在与桌面窗口相关的窗口，可以说就是当前程序的框架窗口，但不包括其他应用程序的窗口上显示被拖拽的图像。因此要使得被拖拽的图像在所有的窗口上而不仅仅是应用程序的框架窗口上显示，就需要调用CWnd::SetCapture函数。一旦调用了SetCapture函数，则在当前应用程序的非框架窗口，包括系统菜单上的鼠标按键动作均被发送到当前CWnd<br>对象，直到调用ReleaseCapture为止）。<br>然后就是在鼠标移动的消息响应函数中调用CImageList::DragMove函数移动被拖拽的图像，使之与鼠标的移动位置同步。最后是调用CImageList::DragShowNolock函数隐藏或显示拖拽的图像，但它并不是必须的，也可以不调用，因此之前已经调用过CImageList::DragEnter函数显示拖拽的图像了。当传递true值显示拖拽的图像时，DragShowNolock在这个过程中不像DragEnter函数一样锁定窗口。<br>值得注意的是，在拖拽节点过程中可以使用CTreeCtrl::HitTest函数判断鼠标滑动过程中所经过的点是否位于树形控件的某一个节点之上，如果是，则返回该树形节点的HTREEITEM。此时可以使用CTreeCtrl::SelectDropTarget函数或CTreeCtrl::SelectItem函数来高亮显示该节点。</p>
</blockquote>
<h3 id="3、树形控件的成员函数"><a href="#3、树形控件的成员函数" class="headerlink" title="3、树形控件的成员函数"></a>3、树形控件的成员函数</h3><blockquote>
<p>InsertItem函数插入一个节点，并返回新插入的节点的HTREEITEM。<br>ItemHasChildren函数根据给定的HTREEITEM判断该节点是否存在子节点。<br>GetChildItem函数根据给定的HTREEITEM获取该节点下子节点的HTREEITEM，如果没有子节点，则返回NULL。<br>GetNextSiblingItem函数根据给定的HTREEITEM获取该节点的下一个同级节点。<br>EnsureVisible函数在必要的时候滚动视图列表控件使得其至少部分可见。需要注意的是，在使用TVE_COLLAPSE调用Expand收缩树形控件后不能再调用该函数，否则收缩操作将无效。</p>
</blockquote>
<h1 id="感伤：WE输了，RNG输了，心碎了。。。"><a href="#感伤：WE输了，RNG输了，心碎了。。。" class="headerlink" title="感伤：WE输了，RNG输了，心碎了。。。"></a>感伤：WE输了，RNG输了，心碎了。。。</h1><h3 id="项目源码可以访问我的码云"><a href="#项目源码可以访问我的码云" class="headerlink" title="项目源码可以访问我的码云"></a><a href="https://gitee.com/AmuUncle/MFC_CSDN.git" target="_blank" rel="external">项目源码可以访问我的码云</a></h3><h3 id="gt-gt-gt-我的私人博客-lt-lt-lt"><a href="#gt-gt-gt-我的私人博客-lt-lt-lt" class="headerlink" title="&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;"></a><a href="http://blog.amuuncle.site/" target="_blank" rel="external">&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;</a></h3>
          
        
      
    </div>
    
    
    
	
	
    

    

    
	

	
	<div>
		
	</div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-tags" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://amuuncle.site/2017/10/29/第11节-MFC之列表控件CListCtrl/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="阿木大叔">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://ip.freep.cn/593194/touxiang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="AmuUncle">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/29/第11节-MFC之列表控件CListCtrl/" itemprop="url">第11节 MFC之列表控件CListCtrl</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-29T21:14:48+08:00">
                2017-10-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MFC从入门到放弃/" itemprop="url" rel="index">
                    <span itemprop="name">MFC从入门到放弃</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Windows编程基础–第11节-MFC之列表控件CListCtrl"><a href="#Windows编程基础–第11节-MFC之列表控件CListCtrl" class="headerlink" title="Windows编程基础–第11节 MFC之列表控件CListCtrl"></a>Windows编程基础–第11节 MFC之列表控件CListCtrl</h1><p>在MFC程序中列表控件也是使用很频繁的控件，例如windows的资源管理器就可以用列表控件来实现，如下图：<br><img src="http://img.blog.csdn.net/20171029194504658?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>列表控件具有以下四种视图：</p>
<blockquote>
<ol>
<li>大图标</li>
<li>小图标</li>
<li>列表</li>
<li>详细信息<h2 id="1-新建项目"><a href="#1-新建项目" class="headerlink" title="1. 新建项目"></a>1. 新建项目</h2>新建一个基于对话框项目“day13”，布置界面如下，从左侧“工具箱”拖动一个List control到界面，再加上两个按钮及Combo Box，如图：<br><img src="http://img.blog.csdn.net/20171029195344235?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></li>
</ol>
</blockquote>
<table>
<thead>
<tr>
<th>控件名</th>
<th style="text-align:right">控件ID</th>
</tr>
</thead>
<tbody>
<tr>
<td>List control</td>
<td style="text-align:right">IDC_LIST_VIEW</td>
</tr>
<tr>
<td>Combo Box</td>
<td style="text-align:right">IDC_COMBO2</td>
</tr>
<tr>
<td>添加行</td>
<td style="text-align:right">IDC_BUTTON_ADD</td>
</tr>
<tr>
<td>删除行</td>
<td style="text-align:right">IDC_BUTTON_DEL</td>
</tr>
</tbody>
</table>
<h2 id="2-添加列表控件变量"><a href="#2-添加列表控件变量" class="headerlink" title="2. 添加列表控件变量"></a>2. 添加列表控件变量</h2><p>单击选中列表控件，右击选择-&gt;“添加变量”，添加变量名为m_list,如下：<br><img src="http://img.blog.csdn.net/20171029195933714?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h2 id="3-初始化列表控件"><a href="#3-初始化列表控件" class="headerlink" title="3. 初始化列表控件"></a>3. 初始化列表控件</h2><p>切换到对话框的初始化函数（OnInitDialog()），我们来给列表控件增加三列，<br><img src="http://img.blog.csdn.net/20171029200613135?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">m_list.ModifyStyle(LVS_TYPEMASK, LVS_REPORT); //设置列表控件样式为详细信息</div><div class="line">m_list.InsertColumn(0,_T(&quot;第一列&quot;),LVCFMT_LEFT,120);</div><div class="line">m_list.InsertColumn(1,_T(&quot;第二列&quot;),LVCFMT_LEFT,120);</div><div class="line">m_list.InsertColumn(2,_T(&quot;第三列&quot;),LVCFMT_LEFT,120);</div></pre></td></tr></table></figure>
<h2 id="4-添加列表图标"><a href="#4-添加列表图标" class="headerlink" title="4. 添加列表图标"></a>4. 添加列表图标</h2><p>自行下载或者制作两个bmp图标，分别为16<em>16，和32</em>32；将图标复制到项目的res资源目录中，<img src="http://img.blog.csdn.net/20171029201802886?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>切换到资源视图，右击添加资源，导入我们准备好的图标，如图所示：<br><img src="http://img.blog.csdn.net/20171029201954651?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>导入好之后我们可以更改位图ID，如图所示：<br><img src="http://img.blog.csdn.net/20171029202051457?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>接下来我们在day13.h的头文件中添加两个成员变量：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">CImageList m_ilLarge;</div><div class="line">CImageList m_ilSmall;</div></pre></td></tr></table></figure>
<p>分别来对应32<em>32，和16</em>16；<br>然后我们再切换到初始化函数中，添加如下四行代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">m_ilLarge.Create(IDB_BITMAP_32, 32, 1,RGB(255,0,255));</div><div class="line">m_ilSmall.Create(IDB_BITMAP_16, 16, 1,RGB(255,0,255));</div><div class="line"></div><div class="line">m_list.SetImageList(&amp;m_ilLarge,LVSIL_NORMAL);</div><div class="line">m_list.SetImageList(&amp;m_ilSmall,LVSIL_SMALL);</div></pre></td></tr></table></figure>
<h2 id="5-实现添加行按钮函数"><a href="#5-实现添加行按钮函数" class="headerlink" title="5. 实现添加行按钮函数"></a>5. 实现添加行按钮函数</h2><p>双击“添加行”按钮，编辑按钮点击方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">void Cday13Dlg::OnBnClickedButtonAdd()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	int nCount = m_list.GetItemCount();</div><div class="line">	CString strText;</div><div class="line">	strText.Format(_T(&quot;第%d行，第一列&quot;), nCount + 1);</div><div class="line">	m_list.InsertItem(nCount,strText,0);</div><div class="line">	strText.Format(_T(&quot;第%d行，第二列&quot;), nCount + 1);</div><div class="line">	m_list.SetItemText(nCount,1,strText);</div><div class="line">	strText.Format(_T(&quot;第%d行，第三列&quot;), nCount + 1);</div><div class="line">	m_list.SetItemText(nCount,2,strText);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>注意，只有添加第一行第一个元素是才是InsertItem，之后的添加都应该是SetItemText，防止出错；</p>
<h2 id="5-实现删除行按钮函数"><a href="#5-实现删除行按钮函数" class="headerlink" title="5. 实现删除行按钮函数"></a>5. 实现删除行按钮函数</h2><p>双击“删除行”按钮，编辑按钮点击方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">void Cday13Dlg::OnBnClickedButtonDel()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	int nCount = m_list.GetItemCount();</div><div class="line">	for (int i = nCount; i&gt;=0 ; --i)</div><div class="line">	&#123;</div><div class="line">		if (m_list.GetItemState(i,LVIS_SELECTED) == LVIS_SELECTED)</div><div class="line">		&#123;</div><div class="line">			m_list.DeleteItem(i);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这样就实现了删除行的按钮，并且所有被选中的行都会被删除，按住Ctrl选中多行，点击删除，所有被选中的行都会被删除；</p>
<h2 id="6-实现列表控件的样式切换"><a href="#6-实现列表控件的样式切换" class="headerlink" title="6. 实现列表控件的样式切换"></a>6. 实现列表控件的样式切换</h2><p>切换到资源视图，单击Combo Box，打开属性-&gt;data;输入：</p>
<blockquote>
<p>大图标;小图标;详细信息;列表;</p>
</blockquote>
<p>如图：<br><img src="http://img.blog.csdn.net/20171029205119435?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>继续编辑Combo Box的属性，选择“控件事件”，添加CBN_Selchange事件，如图：<br><img src="http://img.blog.csdn.net/20171029205441857?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>编辑Combo Box的OnCbnSelchangeCombo2处理函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">void Cday13Dlg::OnCbnSelchangeCombo2()</div><div class="line">&#123;</div><div class="line">	// TODO: 在此添加控件通知处理程序代码</div><div class="line">	DWORD dwStyle;</div><div class="line">	CComboBox *pView;</div><div class="line">	pView = (CComboBox *)GetDlgItem(IDC_COMBO2);</div><div class="line">	switch(pView-&gt;GetCurSel())</div><div class="line">	&#123;</div><div class="line">	case 0:</div><div class="line">		dwStyle = LVS_ICON;</div><div class="line">		break;</div><div class="line">	case 1:</div><div class="line">		dwStyle = LVS_SMALLICON;</div><div class="line">		break;</div><div class="line">	case 2:</div><div class="line">		dwStyle = LVS_LIST;</div><div class="line">		break;</div><div class="line">	case 3:</div><div class="line">		dwStyle = LVS_REPORT;</div><div class="line">		break;</div><div class="line">	default:</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	m_list.ModifyStyle(LVS_TYPEMASK,dwStyle);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>很明显，先用GetDlgItem获取Combo Box的对象，然后判断Combo Box的选中的是哪一项，记录选中项的列表类型，最后设置列表属性；</p>
<h2 id="最后效果图："><a href="#最后效果图：" class="headerlink" title="最后效果图："></a>最后效果图：</h2><p>大图标:<br><img src="http://img.blog.csdn.net/20171029210611657?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>小图标：<br><img src="http://img.blog.csdn.net/20171029210644041?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>列表：<br><img src="http://img.blog.csdn.net/20171029210701658?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>详细信息：<br><img src="http://img.blog.csdn.net/20171029210716406?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjU1NDkzMDk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<h3 id="项目源码可以访问我的码云"><a href="#项目源码可以访问我的码云" class="headerlink" title="项目源码可以访问我的码云"></a><a href="https://gitee.com/AmuUncle/MFC_CSDN.git" target="_blank" rel="external">项目源码可以访问我的码云</a></h3><h3 id="gt-gt-gt-我的私人博客-lt-lt-lt"><a href="#gt-gt-gt-我的私人博客-lt-lt-lt" class="headerlink" title="&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;"></a><a href="http://blog.amuuncle.site/" target="_blank" rel="external">&gt;&gt;&gt;我的私人博客&lt;&lt;&lt;</a></h3>
          
        
      
    </div>
    
    
    
	
	
    

    

    
	

	
	<div>
		
	</div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="https://ip.freep.cn/593194/touxiang.jpg"
                alt="阿木大叔" />
            
              <p class="site-author-name" itemprop="name">阿木大叔</p>
              <p class="site-description motion-element" itemprop="description">我的梦想就是努力实现小时候吹过的牛！</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">23</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://gitee.com/AmuUncle" target="_blank" title="码云">
                    
                      <i class="fa fa-fw fa-github"></i>码云</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:AmuUncle@163.com" target="_blank" title="E-Mail">
                    
                      <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            
          </div>

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://blog.csdn.net/qq_25549309" title="CSDN" target="_blank">CSDN</a>
                  </li>
                
              </ul>
            </div>
          

          <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=29567189&auto=1&height=66"></iframe>
        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; 阿木大叔 &mdash; <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">2017-2020 AmuUncle.site</span>

  
</div>







<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>



        


<script>
  	var _mtac = {};
  	(function() {
  		var mta = document.createElement("script");
  		mta.src = "https://pingjs.qq.com/h5/stats.js?v2.0.4";
  		mta.setAttribute("name", "MTAH5");
  		mta.setAttribute("sid", "63993238");

  		var s = document.getElementsByTagName("script")[0];
  		s.parentNode.insertBefore(mta, s);
  	})();
</script>






        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  

  

  

  
  
<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js">
</script>

<script type="text/javascript" src="/js/src/love.js"></script>
</body>
</html>
